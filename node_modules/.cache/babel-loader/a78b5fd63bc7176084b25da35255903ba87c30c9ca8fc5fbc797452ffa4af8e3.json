{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\josep\\\\Documents\\\\Sistema de Encuestas por Voz\\\\client\\\\src\\\\pages\\\\TakeSurvey.jsx\",\n  _s = $RefreshSig$();\nimport React, { useState, useEffect } from 'react';\nimport { useParams, useNavigate } from 'react-router-dom';\nimport axios from 'axios';\nimport { isSpeechRecognitionSupported, isSpeechSynthesisSupported, listenForSpeech, processVoiceResponse, checkMicrophonePermission } from '../utils/voiceSurveyAPI';\nimport SimpleVoice from '../components/SimpleVoice';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst TakeSurvey = () => {\n  _s();\n  const {\n    surveyId\n  } = useParams();\n  const navigate = useNavigate();\n  const [survey, setSurvey] = useState(null);\n  const [loading, setLoading] = useState(true);\n  const [currentStep, setCurrentStep] = useState('welcome'); // welcome, name, questions, thanks\n  const [currentQuestionIndex, setCurrentQuestionIndex] = useState(0);\n  const [userName, setUserName] = useState('');\n  const [responses, setResponses] = useState([]);\n  const [isSpeaking, setIsSpeaking] = useState(false);\n  const [isListening, setIsListening] = useState(false);\n  const [transcript, setTranscript] = useState('');\n  const [errorMessage, setErrorMessage] = useState('');\n  const [browserSupported, setBrowserSupported] = useState(true);\n  const [microphonePermission, setMicrophonePermission] = useState(null);\n  const [showThankYouMessage, setShowThankYouMessage] = useState(false);\n\n  // Comprobar compatibilidad del navegador y permisos\n  useEffect(() => {\n    const checkCompatibility = async () => {\n      // Verificar si el navegador soporta reconocimiento de voz\n      const speechRecognitionSupported = isSpeechRecognitionSupported();\n      const speechSynthesisSupported = isSpeechSynthesisSupported();\n      if (!speechRecognitionSupported || !speechSynthesisSupported) {\n        setBrowserSupported(false);\n        setErrorMessage('Su navegador no soporta las tecnologías de voz necesarias para esta encuesta. Por favor, use Chrome, Edge o Safari.');\n        return;\n      }\n\n      // Verificar permisos de micrófono\n      const hasMicrophonePermission = await checkMicrophonePermission();\n      setMicrophonePermission(hasMicrophonePermission);\n      if (!hasMicrophonePermission) {\n        setErrorMessage('Necesitamos permiso para usar su micrófono. Por favor, permita el acceso cuando se le solicite.');\n      }\n    };\n    checkCompatibility();\n  }, []);\n\n  // Obtener datos de la encuesta\n  useEffect(() => {\n    const fetchSurvey = async () => {\n      try {\n        setLoading(true);\n        console.log(`Intentando cargar la encuesta con ID: ${surveyId}`);\n\n        // Usar el endpoint público para la encuesta\n        const response = await axios.get(`${process.env.REACT_APP_API_URL || 'http://localhost:5000'}/api/surveys/public/${surveyId}`);\n        if (response.data) {\n          console.log('Encuesta cargada exitosamente:', response.data);\n          setSurvey(response.data);\n          // Inicializar array de respuestas\n          setResponses(response.data.questions.map(() => ({\n            value: '',\n            timestamp: null\n          })));\n        } else {\n          console.error('La respuesta no contiene datos');\n          setErrorMessage('La encuesta no contiene datos válidos.');\n        }\n        setLoading(false);\n      } catch (error) {\n        console.error('Error fetching survey:', error);\n\n        // Mensajes de error más específicos\n        if (error.response) {\n          // El servidor respondió con un código de error\n          if (error.response.status === 404) {\n            setErrorMessage('Encuesta no encontrada. El ID proporcionado no corresponde a ninguna encuesta existente.');\n          } else if (error.response.status === 403) {\n            setErrorMessage('Esta encuesta ya no está activa o no es pública.');\n          } else {\n            setErrorMessage(`Error del servidor: ${error.response.data.message || 'Error desconocido'}`);\n          }\n        } else if (error.request) {\n          // La solicitud se hizo pero no se recibió respuesta\n          setErrorMessage('No se pudo conectar con el servidor. Verifica tu conexión a internet.');\n        } else {\n          // Error al configurar la solicitud\n          setErrorMessage(`Error al intentar cargar la encuesta: ${error.message}`);\n        }\n        setLoading(false);\n      }\n    };\n    if (surveyId) {\n      fetchSurvey();\n    }\n  }, [surveyId]);\n\n  // Función para cuando termina de hablar la pregunta\n  const onQuestionSpeakEnd = () => {\n    setTimeout(startListening, 500);\n  };\n\n  // Función para cuando termina de hablar el mensaje de agradecimiento\n  const onThankYouSpeakEnd = async () => {\n    try {\n      // Enviar respuestas al servidor\n      await submitResponses();\n    } catch (error) {\n      console.error('Error submitting responses:', error);\n    }\n  };\n\n  // Función para enviar respuestas al servidor\n  const submitResponses = async () => {\n    try {\n      // Transformar respuestas al formato del servidor\n      const formattedResponses = responses.map((response, index) => ({\n        questionId: survey.questions[index]._id,\n        value: response.value,\n        timestamp: response.timestamp\n      }));\n\n      // Enviar a la API\n      await axios.post(`${process.env.REACT_APP_API_URL || 'http://localhost:5000'}/api/responses`, {\n        surveyId: survey._id,\n        respondentName: userName,\n        answers: formattedResponses,\n        userAgent: navigator.userAgent,\n        completed: true\n      });\n      console.log('Respuestas enviadas correctamente');\n    } catch (error) {\n      console.error('Error enviando respuestas:', error);\n    }\n  };\n\n  // Función para iniciar escucha\n  const startListening = async () => {\n    if (isListening) return;\n    setErrorMessage('');\n    setTranscript('');\n    setIsListening(true);\n    try {\n      const speechResult = await listenForSpeech();\n      setTranscript(speechResult);\n      processResponse(speechResult);\n    } catch (error) {\n      console.error('Error en reconocimiento de voz:', error);\n      setIsListening(false);\n      setErrorMessage('Error en el reconocimiento de voz. Por favor, intente nuevamente.');\n    }\n  };\n\n  // Función para procesar la respuesta del usuario\n  const processResponse = text => {\n    if (!text) return;\n    setIsListening(false);\n    if (currentStep === 'name') {\n      setUserName(text);\n      // En lugar de síntesis automática, mostramos el mensaje y usamos SimpleVoice\n      const welcomeMessage = `Gracias, ${text}. Vamos a empezar con la encuesta \"${survey.title}\".`;\n      setTranscript(welcomeMessage);\n      setTimeout(() => {\n        setCurrentStep('questions');\n      }, 1500);\n    } else if (currentStep === 'questions') {\n      const currentQuestion = survey.questions[currentQuestionIndex];\n\n      // Procesar respuesta según el tipo de pregunta\n      if (currentQuestion.type === 'rating') {\n        // Extraer número de la respuesta\n        const processedResponse = processVoiceResponse(text, 'rating');\n        if (processedResponse) {\n          saveResponse(processedResponse);\n        } else {\n          setErrorMessage('Por favor, responda con un número del 1 al 5.');\n          setTimeout(startListening, 1000);\n        }\n      } else if (currentQuestion.type === 'yesno') {\n        // Verificar si la respuesta es sí o no\n        const processedResponse = processVoiceResponse(text, 'yesno');\n        if (processedResponse) {\n          saveResponse(processedResponse);\n        } else {\n          setErrorMessage('Por favor, responda con sí o no.');\n          setTimeout(startListening, 1000);\n        }\n      } else {\n        // Pregunta abierta\n        saveResponse(text);\n      }\n    }\n  };\n\n  // Función para guardar respuesta y pasar a la siguiente pregunta\n  const saveResponse = value => {\n    const updatedResponses = [...responses];\n    updatedResponses[currentQuestionIndex] = {\n      value,\n      timestamp: new Date().toISOString()\n    };\n    setResponses(updatedResponses);\n\n    // Verificar si hay más preguntas\n    if (currentQuestionIndex < survey.questions.length - 1) {\n      setCurrentQuestionIndex(currentQuestionIndex + 1);\n    } else {\n      // Fin de la encuesta\n      setCurrentStep('thanks');\n    }\n  };\n\n  // Manejar clic en botón de micrófono\n  const handleMicrophoneClick = () => {\n    if (isListening) {\n      setIsListening(false);\n    } else {\n      startListening();\n    }\n  };\n\n  // Manejar clic en botones de opciones \n  const handleOptionClick = value => {\n    if (isListening) return;\n    processResponse(value);\n  };\n\n  // Solicitar permisos de micrófono\n  const requestMicrophonePermission = async () => {\n    try {\n      const permission = await checkMicrophonePermission();\n      setMicrophonePermission(permission);\n      if (permission) {\n        // Iniciar la encuesta si se conceden los permisos\n        setCurrentStep('welcome');\n      } else {\n        setErrorMessage('No se pudo obtener permiso para el micrófono. Por favor, permita el acceso en la configuración de su navegador.');\n      }\n    } catch (error) {\n      console.error('Error al solicitar permisos de micrófono:', error);\n      setErrorMessage('Error al solicitar permisos de micrófono.');\n    }\n  };\n  if (loading) {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"flex justify-center my-12\",\n      children: /*#__PURE__*/_jsxDEV(\"svg\", {\n        className: \"animate-spin h-8 w-8 text-primary-500\",\n        xmlns: \"http://www.w3.org/2000/svg\",\n        fill: \"none\",\n        viewBox: \"0 0 24 24\",\n        children: [/*#__PURE__*/_jsxDEV(\"circle\", {\n          className: \"opacity-25\",\n          cx: \"12\",\n          cy: \"12\",\n          r: \"10\",\n          stroke: \"currentColor\",\n          strokeWidth: \"4\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 264,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"path\", {\n          className: \"opacity-75\",\n          fill: \"currentColor\",\n          d: \"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 265,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 263,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 262,\n      columnNumber: 7\n    }, this);\n  }\n  if (!survey) {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"card text-center py-12\",\n      children: [/*#__PURE__*/_jsxDEV(\"svg\", {\n        xmlns: \"http://www.w3.org/2000/svg\",\n        className: \"h-16 w-16 mx-auto text-gray-400 mb-4\",\n        fill: \"none\",\n        viewBox: \"0 0 24 24\",\n        stroke: \"currentColor\",\n        children: /*#__PURE__*/_jsxDEV(\"path\", {\n          strokeLinecap: \"round\",\n          strokeLinejoin: \"round\",\n          strokeWidth: 2,\n          d: \"M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 275,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 274,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"h3\", {\n        className: \"text-lg font-medium text-gray-800 mb-2\",\n        children: \"Encuesta no encontrada\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 277,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n        className: \"text-gray-600 mb-6\",\n        children: \"La encuesta que est\\xE1s buscando no existe o ha sido eliminada.\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 278,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: () => navigate('/'),\n        className: \"btn btn-primary\",\n        children: \"Volver al Inicio\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 279,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 273,\n      columnNumber: 7\n    }, this);\n  }\n  if (!browserSupported) {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"card text-center py-12\",\n      children: [/*#__PURE__*/_jsxDEV(\"svg\", {\n        xmlns: \"http://www.w3.org/2000/svg\",\n        className: \"h-16 w-16 mx-auto text-orange-400 mb-4\",\n        fill: \"none\",\n        viewBox: \"0 0 24 24\",\n        stroke: \"currentColor\",\n        children: /*#__PURE__*/_jsxDEV(\"path\", {\n          strokeLinecap: \"round\",\n          strokeLinejoin: \"round\",\n          strokeWidth: 2,\n          d: \"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 290,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 289,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"h3\", {\n        className: \"text-lg font-medium text-gray-800 mb-2\",\n        children: \"Navegador no compatible\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 292,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n        className: \"text-gray-600 mb-6\",\n        children: \"Esta aplicaci\\xF3n requiere un navegador compatible con la API de Reconocimiento de Voz. Por favor, utilice Chrome, Edge o Safari para continuar.\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 293,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: () => window.location.reload(),\n        className: \"btn btn-primary\",\n        children: \"Intentar Nuevamente\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 297,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 288,\n      columnNumber: 7\n    }, this);\n  }\n  if (microphonePermission === false) {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"card text-center py-12\",\n      children: [/*#__PURE__*/_jsxDEV(\"svg\", {\n        xmlns: \"http://www.w3.org/2000/svg\",\n        className: \"h-16 w-16 mx-auto text-orange-400 mb-4\",\n        fill: \"none\",\n        viewBox: \"0 0 24 24\",\n        stroke: \"currentColor\",\n        children: /*#__PURE__*/_jsxDEV(\"path\", {\n          strokeLinecap: \"round\",\n          strokeLinejoin: \"round\",\n          strokeWidth: 2,\n          d: \"M12 11c0 3.517-1.009 6.799-2.753 9.571m-3.44-2.04l.054-.09A13.916 13.916 0 008 11a4 4 0 118 0c0 1.017-.07 2.019-.203 3m-2.118 6.844A21.88 21.88 0 0015.171 17m3.839 1.132c.645-2.266.99-4.659.99-7.132A8 8 0 008 4.07M3 15.364c.64-1.319 1-2.8 1-4.364 0-1.457.39-2.823 1.07-4\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 308,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 307,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"h3\", {\n        className: \"text-lg font-medium text-gray-800 mb-2\",\n        children: \"Permiso de Micr\\xF3fono Requerido\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 310,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n        className: \"text-gray-600 mb-6\",\n        children: \"Para participar en esta encuesta por voz, necesitamos permiso para usar su micr\\xF3fono. Por favor, haga clic en el bot\\xF3n debajo para conceder acceso.\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 311,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: requestMicrophonePermission,\n        className: \"btn btn-primary\",\n        children: \"Permitir Micr\\xF3fono\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 315,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 306,\n      columnNumber: 7\n    }, this);\n  }\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"max-w-2xl mx-auto text-center\",\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"card mb-6\",\n      children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n        className: \"text-2xl font-bold mb-2\",\n        children: survey.title\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 325,\n        columnNumber: 9\n      }, this), survey.description && /*#__PURE__*/_jsxDEV(\"p\", {\n        className: \"text-gray-600 mb-6\",\n        children: survey.description\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 326,\n        columnNumber: 32\n      }, this), errorMessage && /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded mb-4\",\n        children: [errorMessage, /*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: () => setErrorMessage(''),\n          className: \"float-right font-bold\",\n          children: \"\\xD7\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 332,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 330,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"mb-8\",\n        children: [currentStep === 'welcome' && /*#__PURE__*/_jsxDEV(\"div\", {\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"text-lg mb-4\",\n            children: \"Mensaje de bienvenida:\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 345,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"p-4 bg-blue-50 rounded-lg mb-4\",\n            children: survey.welcomeMessage\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 346,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(SimpleVoice, {\n            text: survey.welcomeMessage,\n            onSpeakEnd: () => {\n              setTimeout(() => setCurrentStep('name'), 500);\n            }\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 349,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            onClick: () => setCurrentStep('name'),\n            className: \"btn btn-outline mt-2\",\n            children: \"Continuar sin audio\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 355,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 344,\n          columnNumber: 13\n        }, this), currentStep === 'name' && /*#__PURE__*/_jsxDEV(\"div\", {\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"text-lg mb-4\",\n            children: \"\\xBFPodr\\xEDa decirme su nombre, por favor?\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 366,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(SimpleVoice, {\n            text: \"\\xBFPodr\\xEDa decirme su nombre, por favor?\",\n            onSpeakEnd: startListening\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 367,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            onClick: handleMicrophoneClick,\n            className: `btn ${isListening ? 'btn-red-500' : 'btn-primary'} mt-4`,\n            children: isListening ? 'Detener micrófono' : 'Activar micrófono'\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 371,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 365,\n          columnNumber: 13\n        }, this), currentStep === 'questions' && survey.questions[currentQuestionIndex] && /*#__PURE__*/_jsxDEV(\"div\", {\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"text-sm text-gray-500 mb-2\",\n            children: [\"Pregunta \", currentQuestionIndex + 1, \" de \", survey.questions.length]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 382,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"text-lg font-medium mb-4\",\n            children: survey.questions[currentQuestionIndex].text\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 385,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(SimpleVoice, {\n            text: survey.questions[currentQuestionIndex].text,\n            onSpeakEnd: onQuestionSpeakEnd\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 389,\n            columnNumber: 15\n          }, this), survey.questions[currentQuestionIndex].type === 'rating' && /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"flex justify-center space-x-2 mb-4 mt-4\",\n            children: [1, 2, 3, 4, 5].map(num => /*#__PURE__*/_jsxDEV(\"button\", {\n              className: \"w-12 h-12 rounded-full bg-gray-200 hover:bg-primary-100 flex items-center justify-center font-medium text-gray-800\",\n              onClick: () => handleOptionClick(num.toString()),\n              disabled: isListening,\n              children: num\n            }, num, false, {\n              fileName: _jsxFileName,\n              lineNumber: 397,\n              columnNumber: 21\n            }, this))\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 395,\n            columnNumber: 17\n          }, this), survey.questions[currentQuestionIndex].type === 'yesno' && /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"flex justify-center space-x-4 mb-4 mt-4\",\n            children: [/*#__PURE__*/_jsxDEV(\"button\", {\n              className: \"btn btn-outline px-8\",\n              onClick: () => handleOptionClick('No'),\n              disabled: isListening,\n              children: \"No\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 411,\n              columnNumber: 19\n            }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n              className: \"btn btn-primary px-8\",\n              onClick: () => handleOptionClick('Sí'),\n              disabled: isListening,\n              children: \"S\\xED\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 418,\n              columnNumber: 19\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 410,\n            columnNumber: 17\n          }, this), survey.questions[currentQuestionIndex].type === 'single' && survey.questions[currentQuestionIndex].options && /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"flex flex-col space-y-2 mb-4 mt-4\",\n            children: survey.questions[currentQuestionIndex].options.map((option, index) => /*#__PURE__*/_jsxDEV(\"button\", {\n              className: \"btn btn-outline w-full text-left px-4 py-2\",\n              onClick: () => handleOptionClick(option),\n              disabled: isListening,\n              children: option\n            }, index, false, {\n              fileName: _jsxFileName,\n              lineNumber: 433,\n              columnNumber: 23\n            }, this))\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 431,\n            columnNumber: 19\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            className: `w-16 h-16 mx-auto mt-4 rounded-full flex items-center justify-center transition-colors ${isListening ? 'bg-red-500 text-white animate-pulse' : 'bg-primary-500 text-white hover:bg-primary-600'}`,\n            onClick: handleMicrophoneClick,\n            title: isListening ? 'Detener grabación' : 'Iniciar grabación',\n            children: isListening ? /*#__PURE__*/_jsxDEV(\"svg\", {\n              xmlns: \"http://www.w3.org/2000/svg\",\n              className: \"h-6 w-6\",\n              fill: \"none\",\n              viewBox: \"0 0 24 24\",\n              stroke: \"currentColor\",\n              children: [/*#__PURE__*/_jsxDEV(\"path\", {\n                strokeLinecap: \"round\",\n                strokeLinejoin: \"round\",\n                strokeWidth: 2,\n                d: \"M21 12a9 9 0 11-18 0 9 9 0 0118 0z\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 463,\n                columnNumber: 21\n              }, this), /*#__PURE__*/_jsxDEV(\"path\", {\n                strokeLinecap: \"round\",\n                strokeLinejoin: \"round\",\n                strokeWidth: 2,\n                d: \"M9 10a1 1 0 011-1h4a1 1 0 011 1v4a1 1 0 01-1 1h-4a1 1 0 01-1-1v-4z\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 469,\n                columnNumber: 21\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 456,\n              columnNumber: 19\n            }, this) : /*#__PURE__*/_jsxDEV(\"svg\", {\n              xmlns: \"http://www.w3.org/2000/svg\",\n              className: \"h-6 w-6\",\n              fill: \"none\",\n              viewBox: \"0 0 24 24\",\n              stroke: \"currentColor\",\n              children: /*#__PURE__*/_jsxDEV(\"path\", {\n                strokeLinecap: \"round\",\n                strokeLinejoin: \"round\",\n                strokeWidth: 2,\n                d: \"M19 11a7 7 0 01-7 7m0 0a7 7 0 01-7-7m7 7v4m0 0H8m4 0h4m-4-8a3 3 0 01-3-3V5a3 3 0 116 0v6a3 3 0 01-3 3z\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 484,\n                columnNumber: 21\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 477,\n              columnNumber: 19\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 446,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 381,\n          columnNumber: 13\n        }, this), currentStep === 'thanks' && /*#__PURE__*/_jsxDEV(\"div\", {\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"text-lg mb-4\",\n            children: survey.farewell\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 498,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(SimpleVoice, {\n            text: survey.farewell,\n            onSpeakEnd: onThankYouSpeakEnd\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 499,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 497,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 342,\n        columnNumber: 9\n      }, this), transcript && /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"bg-gray-100 p-4 rounded-lg mb-6\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"text-sm text-gray-500 mb-1\",\n          children: \"Tu respuesta:\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 510,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"text-lg\",\n          children: transcript\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 511,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 509,\n        columnNumber: 11\n      }, this), currentStep === 'questions' && /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"mt-8\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"w-full bg-gray-200 rounded-full h-2.5\",\n          children: /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"bg-primary-500 h-2.5 rounded-full\",\n            style: {\n              width: `${currentQuestionIndex / survey.questions.length * 100}%`\n            }\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 519,\n            columnNumber: 15\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 518,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"text-xs text-gray-500 mt-2\",\n          children: [currentQuestionIndex, \" de \", survey.questions.length, \" preguntas completadas\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 524,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 517,\n        columnNumber: 11\n      }, this), currentStep === 'thanks' && /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"mt-6 space-y-4\",\n        children: [/*#__PURE__*/_jsxDEV(\"p\", {\n          className: \"text-green-600\",\n          children: \"Sus respuestas han sido guardadas correctamente.\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 533,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: () => navigate('/surveys/public'),\n          className: \"btn btn-primary\",\n          children: \"Ver Otras Encuestas\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 534,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: () => navigate('/'),\n          className: \"btn btn-outline block mx-auto mt-2\",\n          children: \"Volver al Inicio\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 540,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 532,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 324,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"bg-gray-50 p-4 rounded-lg text-sm text-gray-600\",\n      children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n        className: \"font-medium mb-2\",\n        children: \"Instrucciones:\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 552,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"ul\", {\n        className: \"list-disc list-inside space-y-1\",\n        children: [/*#__PURE__*/_jsxDEV(\"li\", {\n          children: \"Haga clic en el bot\\xF3n \\\"Leer en voz alta\\\" para escuchar las preguntas\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 554,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"li\", {\n          children: \"Haga clic en el bot\\xF3n del micr\\xF3fono para comenzar a hablar\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 555,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"li\", {\n          children: \"Responda claramente a las preguntas cuando se le indique\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 556,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"li\", {\n          children: \"Para preguntas de calificaci\\xF3n, responda con un n\\xFAmero del 1 al 5\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 557,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"li\", {\n          children: \"Para preguntas de s\\xED/no, responda con \\\"s\\xED\\\" o \\\"no\\\"\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 558,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"li\", {\n          children: \"Tambi\\xE9n puede usar los botones en pantalla para responder\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 559,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 553,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 551,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 323,\n    columnNumber: 5\n  }, this);\n};\n_s(TakeSurvey, \"y46PJpJKATglbPC3sbZI8kwlUSY=\", false, function () {\n  return [useParams, useNavigate];\n});\n_c = TakeSurvey;\nexport default TakeSurvey;\nvar _c;\n$RefreshReg$(_c, \"TakeSurvey\");","map":{"version":3,"names":["React","useState","useEffect","useParams","useNavigate","axios","isSpeechRecognitionSupported","isSpeechSynthesisSupported","listenForSpeech","processVoiceResponse","checkMicrophonePermission","SimpleVoice","jsxDEV","_jsxDEV","TakeSurvey","_s","surveyId","navigate","survey","setSurvey","loading","setLoading","currentStep","setCurrentStep","currentQuestionIndex","setCurrentQuestionIndex","userName","setUserName","responses","setResponses","isSpeaking","setIsSpeaking","isListening","setIsListening","transcript","setTranscript","errorMessage","setErrorMessage","browserSupported","setBrowserSupported","microphonePermission","setMicrophonePermission","showThankYouMessage","setShowThankYouMessage","checkCompatibility","speechRecognitionSupported","speechSynthesisSupported","hasMicrophonePermission","fetchSurvey","console","log","response","get","process","env","REACT_APP_API_URL","data","questions","map","value","timestamp","error","status","message","request","onQuestionSpeakEnd","setTimeout","startListening","onThankYouSpeakEnd","submitResponses","formattedResponses","index","questionId","_id","post","respondentName","answers","userAgent","navigator","completed","speechResult","processResponse","text","welcomeMessage","title","currentQuestion","type","processedResponse","saveResponse","updatedResponses","Date","toISOString","length","handleMicrophoneClick","handleOptionClick","requestMicrophonePermission","permission","className","children","xmlns","fill","viewBox","cx","cy","r","stroke","strokeWidth","fileName","_jsxFileName","lineNumber","columnNumber","d","strokeLinecap","strokeLinejoin","onClick","window","location","reload","description","onSpeakEnd","num","toString","disabled","options","option","farewell","style","width","_c","$RefreshReg$"],"sources":["C:/Users/josep/Documents/Sistema de Encuestas por Voz/client/src/pages/TakeSurvey.jsx"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport { useParams, useNavigate } from 'react-router-dom';\nimport axios from 'axios';\nimport {\n  isSpeechRecognitionSupported,\n  isSpeechSynthesisSupported,\n  listenForSpeech,\n  processVoiceResponse,\n  checkMicrophonePermission\n} from '../utils/voiceSurveyAPI';\nimport SimpleVoice from '../components/SimpleVoice';\n\nconst TakeSurvey = () => {\n  const { surveyId } = useParams();\n  const navigate = useNavigate();\n  const [survey, setSurvey] = useState(null);\n  const [loading, setLoading] = useState(true);\n  const [currentStep, setCurrentStep] = useState('welcome'); // welcome, name, questions, thanks\n  const [currentQuestionIndex, setCurrentQuestionIndex] = useState(0);\n  const [userName, setUserName] = useState('');\n  const [responses, setResponses] = useState([]);\n  const [isSpeaking, setIsSpeaking] = useState(false);\n  const [isListening, setIsListening] = useState(false);\n  const [transcript, setTranscript] = useState('');\n  const [errorMessage, setErrorMessage] = useState('');\n  const [browserSupported, setBrowserSupported] = useState(true);\n  const [microphonePermission, setMicrophonePermission] = useState(null);\n  const [showThankYouMessage, setShowThankYouMessage] = useState(false);\n\n  // Comprobar compatibilidad del navegador y permisos\n  useEffect(() => {\n    const checkCompatibility = async () => {\n      // Verificar si el navegador soporta reconocimiento de voz\n      const speechRecognitionSupported = isSpeechRecognitionSupported();\n      const speechSynthesisSupported = isSpeechSynthesisSupported();\n\n      if (!speechRecognitionSupported || !speechSynthesisSupported) {\n        setBrowserSupported(false);\n        setErrorMessage('Su navegador no soporta las tecnologías de voz necesarias para esta encuesta. Por favor, use Chrome, Edge o Safari.');\n        return;\n      }\n\n      // Verificar permisos de micrófono\n      const hasMicrophonePermission = await checkMicrophonePermission();\n      setMicrophonePermission(hasMicrophonePermission);\n\n      if (!hasMicrophonePermission) {\n        setErrorMessage('Necesitamos permiso para usar su micrófono. Por favor, permita el acceso cuando se le solicite.');\n      }\n    };\n\n    checkCompatibility();\n  }, []);\n\n  // Obtener datos de la encuesta\n  useEffect(() => {\n    const fetchSurvey = async () => {\n      try {\n        setLoading(true);\n        console.log(`Intentando cargar la encuesta con ID: ${surveyId}`);\n        \n        // Usar el endpoint público para la encuesta\n        const response = await axios.get(`${process.env.REACT_APP_API_URL || 'http://localhost:5000'}/api/surveys/public/${surveyId}`);\n        \n        if (response.data) {\n          console.log('Encuesta cargada exitosamente:', response.data);\n          setSurvey(response.data);\n          // Inicializar array de respuestas\n          setResponses(response.data.questions.map(() => ({ value: '', timestamp: null })));\n        } else {\n          console.error('La respuesta no contiene datos');\n          setErrorMessage('La encuesta no contiene datos válidos.');\n        }\n        \n        setLoading(false);\n      } catch (error) {\n        console.error('Error fetching survey:', error);\n        \n        // Mensajes de error más específicos\n        if (error.response) {\n          // El servidor respondió con un código de error\n          if (error.response.status === 404) {\n            setErrorMessage('Encuesta no encontrada. El ID proporcionado no corresponde a ninguna encuesta existente.');\n          } else if (error.response.status === 403) {\n            setErrorMessage('Esta encuesta ya no está activa o no es pública.');\n          } else {\n            setErrorMessage(`Error del servidor: ${error.response.data.message || 'Error desconocido'}`);\n          }\n        } else if (error.request) {\n          // La solicitud se hizo pero no se recibió respuesta\n          setErrorMessage('No se pudo conectar con el servidor. Verifica tu conexión a internet.');\n        } else {\n          // Error al configurar la solicitud\n          setErrorMessage(`Error al intentar cargar la encuesta: ${error.message}`);\n        }\n        \n        setLoading(false);\n      }\n    };\n\n    if (surveyId) {\n      fetchSurvey();\n    }\n  }, [surveyId]);\n\n  // Función para cuando termina de hablar la pregunta\n  const onQuestionSpeakEnd = () => {\n    setTimeout(startListening, 500);\n  };\n\n  // Función para cuando termina de hablar el mensaje de agradecimiento\n  const onThankYouSpeakEnd = async () => {\n    try {\n      // Enviar respuestas al servidor\n      await submitResponses();\n    } catch (error) {\n      console.error('Error submitting responses:', error);\n    }\n  };\n\n  // Función para enviar respuestas al servidor\n  const submitResponses = async () => {\n    try {\n      // Transformar respuestas al formato del servidor\n      const formattedResponses = responses.map((response, index) => ({\n        questionId: survey.questions[index]._id,\n        value: response.value,\n        timestamp: response.timestamp\n      }));\n\n      // Enviar a la API\n      await axios.post(`${process.env.REACT_APP_API_URL || 'http://localhost:5000'}/api/responses`, {\n        surveyId: survey._id,\n        respondentName: userName,\n        answers: formattedResponses,\n        userAgent: navigator.userAgent,\n        completed: true\n      });\n\n      console.log('Respuestas enviadas correctamente');\n    } catch (error) {\n      console.error('Error enviando respuestas:', error);\n    }\n  };\n\n  // Función para iniciar escucha\n  const startListening = async () => {\n    if (isListening) return;\n\n    setErrorMessage('');\n    setTranscript('');\n    setIsListening(true);\n\n    try {\n      const speechResult = await listenForSpeech();\n      setTranscript(speechResult);\n      processResponse(speechResult);\n    } catch (error) {\n      console.error('Error en reconocimiento de voz:', error);\n      setIsListening(false);\n      setErrorMessage('Error en el reconocimiento de voz. Por favor, intente nuevamente.');\n    }\n  };\n\n  // Función para procesar la respuesta del usuario\n  const processResponse = (text) => {\n    if (!text) return;\n\n    setIsListening(false);\n\n    if (currentStep === 'name') {\n      setUserName(text);\n      // En lugar de síntesis automática, mostramos el mensaje y usamos SimpleVoice\n      const welcomeMessage = `Gracias, ${text}. Vamos a empezar con la encuesta \"${survey.title}\".`;\n      setTranscript(welcomeMessage);\n      setTimeout(() => {\n        setCurrentStep('questions');\n      }, 1500);\n    } else if (currentStep === 'questions') {\n      const currentQuestion = survey.questions[currentQuestionIndex];\n\n      // Procesar respuesta según el tipo de pregunta\n      if (currentQuestion.type === 'rating') {\n        // Extraer número de la respuesta\n        const processedResponse = processVoiceResponse(text, 'rating');\n        if (processedResponse) {\n          saveResponse(processedResponse);\n        } else {\n          setErrorMessage('Por favor, responda con un número del 1 al 5.');\n          setTimeout(startListening, 1000);\n        }\n      } else if (currentQuestion.type === 'yesno') {\n        // Verificar si la respuesta es sí o no\n        const processedResponse = processVoiceResponse(text, 'yesno');\n        if (processedResponse) {\n          saveResponse(processedResponse);\n        } else {\n          setErrorMessage('Por favor, responda con sí o no.');\n          setTimeout(startListening, 1000);\n        }\n      } else {\n        // Pregunta abierta\n        saveResponse(text);\n      }\n    }\n  };\n\n  // Función para guardar respuesta y pasar a la siguiente pregunta\n  const saveResponse = (value) => {\n    const updatedResponses = [...responses];\n    updatedResponses[currentQuestionIndex] = {\n      value,\n      timestamp: new Date().toISOString()\n    };\n    setResponses(updatedResponses);\n\n    // Verificar si hay más preguntas\n    if (currentQuestionIndex < survey.questions.length - 1) {\n      setCurrentQuestionIndex(currentQuestionIndex + 1);\n    } else {\n      // Fin de la encuesta\n      setCurrentStep('thanks');\n    }\n  };\n\n  // Manejar clic en botón de micrófono\n  const handleMicrophoneClick = () => {\n    if (isListening) {\n      setIsListening(false);\n    } else {\n      startListening();\n    }\n  };\n\n  // Manejar clic en botones de opciones \n  const handleOptionClick = (value) => {\n    if (isListening) return;\n\n    processResponse(value);\n  };\n\n  // Solicitar permisos de micrófono\n  const requestMicrophonePermission = async () => {\n    try {\n      const permission = await checkMicrophonePermission();\n      setMicrophonePermission(permission);\n\n      if (permission) {\n        // Iniciar la encuesta si se conceden los permisos\n        setCurrentStep('welcome');\n      } else {\n        setErrorMessage('No se pudo obtener permiso para el micrófono. Por favor, permita el acceso en la configuración de su navegador.');\n      }\n    } catch (error) {\n      console.error('Error al solicitar permisos de micrófono:', error);\n      setErrorMessage('Error al solicitar permisos de micrófono.');\n    }\n  };\n\n  if (loading) {\n    return (\n      <div className=\"flex justify-center my-12\">\n        <svg className=\"animate-spin h-8 w-8 text-primary-500\" xmlns=\"http://www.w3.org/2000/svg\" fill=\"none\" viewBox=\"0 0 24 24\">\n          <circle className=\"opacity-25\" cx=\"12\" cy=\"12\" r=\"10\" stroke=\"currentColor\" strokeWidth=\"4\"></circle>\n          <path className=\"opacity-75\" fill=\"currentColor\" d=\"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z\"></path>\n        </svg>\n      </div>\n    );\n  }\n\n  if (!survey) {\n    return (\n      <div className=\"card text-center py-12\">\n        <svg xmlns=\"http://www.w3.org/2000/svg\" className=\"h-16 w-16 mx-auto text-gray-400 mb-4\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\n          <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2\" />\n        </svg>\n        <h3 className=\"text-lg font-medium text-gray-800 mb-2\">Encuesta no encontrada</h3>\n        <p className=\"text-gray-600 mb-6\">La encuesta que estás buscando no existe o ha sido eliminada.</p>\n        <button onClick={() => navigate('/')} className=\"btn btn-primary\">\n          Volver al Inicio\n        </button>\n      </div>\n    );\n  }\n\n  if (!browserSupported) {\n    return (\n      <div className=\"card text-center py-12\">\n        <svg xmlns=\"http://www.w3.org/2000/svg\" className=\"h-16 w-16 mx-auto text-orange-400 mb-4\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\n          <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z\" />\n        </svg>\n        <h3 className=\"text-lg font-medium text-gray-800 mb-2\">Navegador no compatible</h3>\n        <p className=\"text-gray-600 mb-6\">\n          Esta aplicación requiere un navegador compatible con la API de Reconocimiento de Voz.\n          Por favor, utilice Chrome, Edge o Safari para continuar.\n        </p>\n        <button onClick={() => window.location.reload()} className=\"btn btn-primary\">\n          Intentar Nuevamente\n        </button>\n      </div>\n    );\n  }\n\n  if (microphonePermission === false) {\n    return (\n      <div className=\"card text-center py-12\">\n        <svg xmlns=\"http://www.w3.org/2000/svg\" className=\"h-16 w-16 mx-auto text-orange-400 mb-4\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\n          <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M12 11c0 3.517-1.009 6.799-2.753 9.571m-3.44-2.04l.054-.09A13.916 13.916 0 008 11a4 4 0 118 0c0 1.017-.07 2.019-.203 3m-2.118 6.844A21.88 21.88 0 0015.171 17m3.839 1.132c.645-2.266.99-4.659.99-7.132A8 8 0 008 4.07M3 15.364c.64-1.319 1-2.8 1-4.364 0-1.457.39-2.823 1.07-4\" />\n        </svg>\n        <h3 className=\"text-lg font-medium text-gray-800 mb-2\">Permiso de Micrófono Requerido</h3>\n        <p className=\"text-gray-600 mb-6\">\n          Para participar en esta encuesta por voz, necesitamos permiso para usar su micrófono.\n          Por favor, haga clic en el botón debajo para conceder acceso.\n        </p>\n        <button onClick={requestMicrophonePermission} className=\"btn btn-primary\">\n          Permitir Micrófono\n        </button>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"max-w-2xl mx-auto text-center\">\n      <div className=\"card mb-6\">\n        <h1 className=\"text-2xl font-bold mb-2\">{survey.title}</h1>\n        {survey.description && <p className=\"text-gray-600 mb-6\">{survey.description}</p>}\n\n        {/* Mostrar mensaje de error si existe */}\n        {errorMessage && (\n          <div className=\"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded mb-4\">\n            {errorMessage}\n            <button\n              onClick={() => setErrorMessage('')}\n              className=\"float-right font-bold\"\n            >\n              &times;\n            </button>\n          </div>\n        )}\n\n        {/* Mostrar estado actual */}\n        <div className=\"mb-8\">\n          {currentStep === 'welcome' && (\n            <div>\n              <div className=\"text-lg mb-4\">Mensaje de bienvenida:</div>\n              <div className=\"p-4 bg-blue-50 rounded-lg mb-4\">\n                {survey.welcomeMessage}\n              </div>\n              <SimpleVoice\n                text={survey.welcomeMessage}\n                onSpeakEnd={() => {\n                  setTimeout(() => setCurrentStep('name'), 500);\n                }}\n              />\n              <button\n                onClick={() => setCurrentStep('name')}\n                className=\"btn btn-outline mt-2\"\n              >\n                Continuar sin audio\n              </button>\n            </div>\n          )}\n\n          {currentStep === 'name' && (\n            <div>\n              <div className=\"text-lg mb-4\">¿Podría decirme su nombre, por favor?</div>\n              <SimpleVoice\n                text=\"¿Podría decirme su nombre, por favor?\"\n                onSpeakEnd={startListening}\n              />\n              <button\n                onClick={handleMicrophoneClick}\n                className={`btn ${isListening ? 'btn-red-500' : 'btn-primary'} mt-4`}\n              >\n                {isListening ? 'Detener micrófono' : 'Activar micrófono'}\n              </button>\n            </div>\n          )}\n\n          {currentStep === 'questions' && survey.questions[currentQuestionIndex] && (\n            <div>\n              <div className=\"text-sm text-gray-500 mb-2\">\n                Pregunta {currentQuestionIndex + 1} de {survey.questions.length}\n              </div>\n              <div className=\"text-lg font-medium mb-4\">\n                {survey.questions[currentQuestionIndex].text}\n              </div>\n\n              <SimpleVoice\n                text={survey.questions[currentQuestionIndex].text}\n                onSpeakEnd={onQuestionSpeakEnd}\n              />\n\n              {survey.questions[currentQuestionIndex].type === 'rating' && (\n                <div className=\"flex justify-center space-x-2 mb-4 mt-4\">\n                  {[1, 2, 3, 4, 5].map((num) => (\n                    <button\n                      key={num}\n                      className=\"w-12 h-12 rounded-full bg-gray-200 hover:bg-primary-100 flex items-center justify-center font-medium text-gray-800\"\n                      onClick={() => handleOptionClick(num.toString())}\n                      disabled={isListening}\n                    >\n                      {num}\n                    </button>\n                  ))}\n                </div>\n              )}\n\n              {survey.questions[currentQuestionIndex].type === 'yesno' && (\n                <div className=\"flex justify-center space-x-4 mb-4 mt-4\">\n                  <button\n                    className=\"btn btn-outline px-8\"\n                    onClick={() => handleOptionClick('No')}\n                    disabled={isListening}\n                  >\n                    No\n                  </button>\n                  <button\n                    className=\"btn btn-primary px-8\"\n                    onClick={() => handleOptionClick('Sí')}\n                    disabled={isListening}\n                  >\n                    Sí\n                  </button>\n                </div>\n              )}\n\n              {/* Para preguntas de selección múltiple */}\n              {survey.questions[currentQuestionIndex].type === 'single' &&\n                survey.questions[currentQuestionIndex].options && (\n                  <div className=\"flex flex-col space-y-2 mb-4 mt-4\">\n                    {survey.questions[currentQuestionIndex].options.map((option, index) => (\n                      <button\n                        key={index}\n                        className=\"btn btn-outline w-full text-left px-4 py-2\"\n                        onClick={() => handleOptionClick(option)}\n                        disabled={isListening}\n                      >\n                        {option}\n                      </button>\n                    ))}\n                  </div>\n                )}\n\n              {/* Botón de micrófono */}\n              <button\n                className={`w-16 h-16 mx-auto mt-4 rounded-full flex items-center justify-center transition-colors ${\n                  isListening\n                    ? 'bg-red-500 text-white animate-pulse'\n                    : 'bg-primary-500 text-white hover:bg-primary-600'\n                }`}\n                onClick={handleMicrophoneClick}\n                title={isListening ? 'Detener grabación' : 'Iniciar grabación'}\n              >\n                {isListening ? (\n                  <svg\n                    xmlns=\"http://www.w3.org/2000/svg\"\n                    className=\"h-6 w-6\"\n                    fill=\"none\"\n                    viewBox=\"0 0 24 24\"\n                    stroke=\"currentColor\"\n                  >\n                    <path\n                      strokeLinecap=\"round\"\n                      strokeLinejoin=\"round\"\n                      strokeWidth={2}\n                      d=\"M21 12a9 9 0 11-18 0 9 9 0 0118 0z\"\n                    />\n                    <path\n                      strokeLinecap=\"round\"\n                      strokeLinejoin=\"round\"\n                      strokeWidth={2}\n                      d=\"M9 10a1 1 0 011-1h4a1 1 0 011 1v4a1 1 0 01-1 1h-4a1 1 0 01-1-1v-4z\"\n                    />\n                  </svg>\n                ) : (\n                  <svg\n                    xmlns=\"http://www.w3.org/2000/svg\"\n                    className=\"h-6 w-6\"\n                    fill=\"none\"\n                    viewBox=\"0 0 24 24\"\n                    stroke=\"currentColor\"\n                  >\n                    <path\n                      strokeLinecap=\"round\"\n                      strokeLinejoin=\"round\"\n                      strokeWidth={2}\n                      d=\"M19 11a7 7 0 01-7 7m0 0a7 7 0 01-7-7m7 7v4m0 0H8m4 0h4m-4-8a3 3 0 01-3-3V5a3 3 0 116 0v6a3 3 0 01-3 3z\"\n                    />\n                  </svg>\n                )}\n              </button>\n            </div>\n          )}\n\n          {currentStep === 'thanks' && (\n            <div>\n              <div className=\"text-lg mb-4\">{survey.farewell}</div>\n              <SimpleVoice\n                text={survey.farewell}\n                onSpeakEnd={onThankYouSpeakEnd}\n              />\n            </div>\n          )}\n        </div>\n\n        {/* Mostrar transcripción */}\n        {transcript && (\n          <div className=\"bg-gray-100 p-4 rounded-lg mb-6\">\n            <div className=\"text-sm text-gray-500 mb-1\">Tu respuesta:</div>\n            <div className=\"text-lg\">{transcript}</div>\n          </div>\n        )}\n\n        {/* Indicadores de progreso */}\n        {currentStep === 'questions' && (\n          <div className=\"mt-8\">\n            <div className=\"w-full bg-gray-200 rounded-full h-2.5\">\n              <div\n                className=\"bg-primary-500 h-2.5 rounded-full\"\n                style={{ width: `${((currentQuestionIndex) / survey.questions.length) * 100}%` }}\n              ></div>\n            </div>\n            <div className=\"text-xs text-gray-500 mt-2\">\n              {currentQuestionIndex} de {survey.questions.length} preguntas completadas\n            </div>\n          </div>\n        )}\n\n        {/* Acciones finales */}\n        {currentStep === 'thanks' && (\n          <div className=\"mt-6 space-y-4\">\n            <p className=\"text-green-600\">Sus respuestas han sido guardadas correctamente.</p>\n            <button\n              onClick={() => navigate('/surveys/public')}\n              className=\"btn btn-primary\"\n            >\n              Ver Otras Encuestas\n            </button>\n            <button\n              onClick={() => navigate('/')}\n              className=\"btn btn-outline block mx-auto mt-2\"\n            >\n              Volver al Inicio\n            </button>\n          </div>\n        )}\n      </div>\n\n      {/* Instrucciones */}\n      <div className=\"bg-gray-50 p-4 rounded-lg text-sm text-gray-600\">\n        <h3 className=\"font-medium mb-2\">Instrucciones:</h3>\n        <ul className=\"list-disc list-inside space-y-1\">\n          <li>Haga clic en el botón \"Leer en voz alta\" para escuchar las preguntas</li>\n          <li>Haga clic en el botón del micrófono para comenzar a hablar</li>\n          <li>Responda claramente a las preguntas cuando se le indique</li>\n          <li>Para preguntas de calificación, responda con un número del 1 al 5</li>\n          <li>Para preguntas de sí/no, responda con \"sí\" o \"no\"</li>\n          <li>También puede usar los botones en pantalla para responder</li>\n        </ul>\n      </div>\n    </div>\n  );\n};\n\nexport default TakeSurvey;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}