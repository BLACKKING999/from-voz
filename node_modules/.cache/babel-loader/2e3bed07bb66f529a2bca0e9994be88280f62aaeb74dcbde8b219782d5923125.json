{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\josep\\\\Documents\\\\Sistema de Encuestas por Voz\\\\client\\\\src\\\\pages\\\\TakeSurvey.jsx\",\n  _s = $RefreshSig$();\nimport React, { useState, useEffect } from 'react';\nimport { useParams, useNavigate } from 'react-router-dom';\nimport { SurveyService, ResponseService } from '../services/apiService';\n\n// Componentes\nimport LoadingSpinner from '../components/LoadingSpinner';\nimport ErrorMessage from '../components/ErrorMessage';\nimport SimpleVoice from '../components/SimpleVoice';\nimport audioService from '../services/audioService';\nimport { jsxDEV as _jsxDEV, Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nconst TakeSurvey = () => {\n  _s();\n  const {\n    surveyId\n  } = useParams();\n  const navigate = useNavigate();\n\n  // Estados\n  const [survey, setSurvey] = useState(null);\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState(null);\n  const [currentQuestionIndex, setCurrentQuestionIndex] = useState(0);\n  const [responses, setResponses] = useState([]);\n  const [isSubmitting, setIsSubmitting] = useState(false);\n  const [showConfirmation, setShowConfirmation] = useState(false);\n  const [currentResponse, setCurrentResponse] = useState('');\n  const [isListening, setIsListening] = useState(false);\n  const [voiceEnabled, setVoiceEnabled] = useState(true);\n  const [speechText, setSpeechText] = useState('');\n\n  // Cargar la encuesta\n  useEffect(() => {\n    const fetchSurvey = async () => {\n      try {\n        const data = await SurveyService.getPublicSurvey(surveyId);\n        console.log('Encuesta cargada:', data);\n        setSurvey(data);\n        // Inicializar respuestas vacías\n        setResponses(new Array(data.questions.length).fill(''));\n      } catch (error) {\n        console.error('Error al cargar la encuesta:', error);\n        setError('No se pudo cargar la encuesta. Verifique que el ID sea correcto y que la encuesta esté activa.');\n      } finally {\n        setLoading(false);\n      }\n    };\n    fetchSurvey();\n\n    // Inicializar sistema de voz\n    audioService.initSpeechSystem();\n    return () => {\n      // Detener cualquier síntesis al desmontar\n      audioService.stop();\n    };\n  }, [surveyId]);\n\n  // Efecto para leer la pregunta actual\n  useEffect(() => {\n    if (survey && voiceEnabled) {\n      const currentQuestion = survey.questions[currentQuestionIndex];\n      if (currentQuestion) {\n        // Si es la primera pregunta y hay mensaje de bienvenida, léelo primero\n        if (currentQuestionIndex === 0 && survey.welcomeMessage) {\n          setSpeechText(`${survey.welcomeMessage}. Pregunta ${currentQuestionIndex + 1}: ${currentQuestion.text}`);\n        } else {\n          setSpeechText(`Pregunta ${currentQuestionIndex + 1}: ${currentQuestion.text}`);\n        }\n      }\n    }\n  }, [currentQuestionIndex, survey, voiceEnabled]);\n\n  // Manejar el cambio de respuesta manual\n  const handleResponseChange = e => {\n    setCurrentResponse(e.target.value);\n  };\n\n  // Guardar la respuesta actual y avanzar a la siguiente pregunta\n  const handleNextQuestion = () => {\n    const updatedResponses = [...responses];\n    updatedResponses[currentQuestionIndex] = currentResponse;\n    setResponses(updatedResponses);\n    if (currentQuestionIndex < survey.questions.length - 1) {\n      setCurrentQuestionIndex(currentQuestionIndex + 1);\n      setCurrentResponse('');\n    } else {\n      setShowConfirmation(true);\n      if (voiceEnabled) {\n        setSpeechText('Por favor, confirma tus respuestas antes de enviar la encuesta.');\n      }\n    }\n  };\n\n  // Volver a la pregunta anterior\n  const handlePreviousQuestion = () => {\n    if (currentQuestionIndex > 0) {\n      setCurrentQuestionIndex(currentQuestionIndex - 1);\n      setCurrentResponse(responses[currentQuestionIndex - 1]);\n    }\n  };\n\n  // Enviar todas las respuestas\n  const handleSubmit = async () => {\n    setIsSubmitting(true);\n    try {\n      // Preparar objeto de respuesta\n      const responseData = {\n        surveyId: survey._id,\n        responses: survey.questions.map((question, index) => ({\n          questionId: question._id,\n          questionText: question.text,\n          responseText: responses[index] || '',\n          questionType: question.type\n        }))\n      };\n\n      // Enviar respuesta a la API\n      await ResponseService.submitResponse(responseData);\n\n      // Redirigir a página de agradecimiento\n      navigate(`/thank-you`, {\n        state: {\n          message: survey.farewell || '¡Gracias por completar la encuesta!'\n        }\n      });\n    } catch (error) {\n      console.error('Error al enviar respuestas:', error);\n      setError('Ocurrió un error al enviar tus respuestas. Por favor, intenta nuevamente.');\n      setIsSubmitting(false);\n    }\n  };\n\n  // Iniciar reconocimiento de voz\n  const startVoiceRecognition = () => {\n    if (!audioService.isSupportedByBrowser()) {\n      setError('Tu navegador no soporta reconocimiento de voz');\n      return;\n    }\n    audioService.init('es-ES');\n    audioService.onResult((transcript, isFinal) => {\n      setCurrentResponse(transcript);\n    });\n    audioService.onEnd(finalTranscript => {\n      setIsListening(false);\n    });\n    audioService.onError(errorMessage => {\n      setError(`Error de reconocimiento: ${errorMessage}`);\n      setIsListening(false);\n    });\n    const started = audioService.start();\n    if (started) {\n      setIsListening(true);\n    } else {\n      setError('No se pudo iniciar el reconocimiento de voz');\n    }\n  };\n\n  // Detener reconocimiento de voz\n  const stopVoiceRecognition = () => {\n    audioService.stop();\n    setIsListening(false);\n  };\n\n  // Alternar el uso de voz\n  const toggleVoice = () => {\n    setVoiceEnabled(!voiceEnabled);\n  };\n\n  // Renderizar pantalla de carga\n  if (loading) {\n    return /*#__PURE__*/_jsxDEV(LoadingSpinner, {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 176,\n      columnNumber: 12\n    }, this);\n  }\n\n  // Renderizar mensaje de error\n  if (error) {\n    return /*#__PURE__*/_jsxDEV(ErrorMessage, {\n      message: error\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 181,\n      columnNumber: 12\n    }, this);\n  }\n\n  // Si no hay encuesta\n  if (!survey) {\n    return /*#__PURE__*/_jsxDEV(ErrorMessage, {\n      message: \"No se encontr\\xF3 la encuesta solicitada.\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 186,\n      columnNumber: 12\n    }, this);\n  }\n\n  // Obtener la pregunta actual\n  const currentQuestion = survey.questions[currentQuestionIndex];\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"max-w-3xl mx-auto p-4\",\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"flex justify-end mb-2\",\n      children: /*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: toggleVoice,\n        className: `px-3 py-1 rounded text-sm ${voiceEnabled ? 'bg-blue-500 text-white' : 'bg-gray-300 text-gray-700'}`,\n        children: voiceEnabled ? '🔊 Voz Activada' : '🔇 Voz Desactivada'\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 196,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 195,\n      columnNumber: 7\n    }, this), voiceEnabled && speechText && /*#__PURE__*/_jsxDEV(SimpleVoice, {\n      text: speechText,\n      onEnd: () => setSpeechText('')\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 206,\n      columnNumber: 9\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"mb-8 text-center\",\n      children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n        className: \"text-3xl font-bold mb-2\",\n        children: survey.title\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 211,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n        className: \"text-gray-600\",\n        children: survey.description\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 212,\n        columnNumber: 9\n      }, this), currentQuestionIndex === 0 && survey.welcomeMessage && /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"mt-4 p-4 bg-blue-50 rounded-lg\",\n        children: /*#__PURE__*/_jsxDEV(\"p\", {\n          children: survey.welcomeMessage\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 215,\n          columnNumber: 13\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 214,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 210,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"mb-6\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"w-full bg-gray-200 rounded-full h-2.5\",\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"bg-blue-600 h-2.5 rounded-full\",\n          style: {\n            width: `${(currentQuestionIndex + 1) / survey.questions.length * 100}%`\n          }\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 223,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 222,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n        className: \"text-right text-sm mt-1\",\n        children: [\"Pregunta \", currentQuestionIndex + 1, \" de \", survey.questions.length]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 228,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 221,\n      columnNumber: 7\n    }, this), showConfirmation ? /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"bg-white rounded-lg shadow-lg p-6\",\n      children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n        className: \"text-2xl font-bold mb-4\",\n        children: \"Confirmar env\\xEDo\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 236,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n        className: \"mb-4\",\n        children: \"\\xBFEst\\xE1s seguro de que deseas enviar tus respuestas?\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 237,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"mb-6\",\n        children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n          className: \"font-bold mb-2\",\n          children: \"Resumen de respuestas:\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 240,\n          columnNumber: 13\n        }, this), survey.questions.map((question, index) => /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"mb-3\",\n          children: [/*#__PURE__*/_jsxDEV(\"p\", {\n            className: \"font-medium\",\n            children: [index + 1, \". \", question.text]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 243,\n            columnNumber: 17\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            className: \"text-gray-700 pl-4\",\n            children: responses[index] || \"(Sin respuesta)\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 244,\n            columnNumber: 17\n          }, this)]\n        }, question._id, true, {\n          fileName: _jsxFileName,\n          lineNumber: 242,\n          columnNumber: 15\n        }, this))]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 239,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"flex justify-between\",\n        children: [/*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: () => setShowConfirmation(false),\n          className: \"px-4 py-2 bg-gray-200 text-gray-800 rounded hover:bg-gray-300\",\n          disabled: isSubmitting,\n          children: \"Volver\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 250,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: handleSubmit,\n          className: \"px-4 py-2 bg-green-600 text-white rounded hover:bg-green-700\",\n          disabled: isSubmitting,\n          children: isSubmitting ? 'Enviando...' : 'Confirmar envío'\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 257,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 249,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 235,\n      columnNumber: 9\n    }, this) : /*#__PURE__*/_jsxDEV(_Fragment, {\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"bg-white rounded-lg shadow-lg p-6 mb-6\",\n        children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n          className: \"text-xl font-bold mb-4\",\n          children: currentQuestion.text\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 270,\n          columnNumber: 13\n        }, this), currentQuestion.type === 'multiple_choice' && currentQuestion.options && /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"mb-4\",\n          children: [/*#__PURE__*/_jsxDEV(\"p\", {\n            className: \"text-sm text-gray-600 mb-2\",\n            children: \"Opciones:\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 275,\n            columnNumber: 17\n          }, this), /*#__PURE__*/_jsxDEV(\"ul\", {\n            className: \"list-disc pl-5\",\n            children: currentQuestion.options.map((option, idx) => /*#__PURE__*/_jsxDEV(\"li\", {\n              className: \"mb-1\",\n              children: option\n            }, idx, false, {\n              fileName: _jsxFileName,\n              lineNumber: 278,\n              columnNumber: 21\n            }, this))\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 276,\n            columnNumber: 17\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 274,\n          columnNumber: 15\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"mt-4\",\n          children: [/*#__PURE__*/_jsxDEV(\"label\", {\n            className: \"block text-sm font-medium text-gray-700 mb-1\",\n            children: \"Tu respuesta:\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 286,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"textarea\", {\n            value: currentResponse,\n            onChange: handleResponseChange,\n            className: \"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500\",\n            rows: \"3\",\n            placeholder: \"Escribe tu respuesta...\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 289,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"flex items-center mt-2\",\n            children: [!isListening ? /*#__PURE__*/_jsxDEV(\"button\", {\n              onClick: startVoiceRecognition,\n              className: \"flex items-center px-3 py-1 bg-blue-500 text-white rounded hover:bg-blue-600\",\n              children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                className: \"mr-1\",\n                children: \"\\uD83C\\uDFA4\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 304,\n                columnNumber: 21\n              }, this), \" Responder por voz\"]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 300,\n              columnNumber: 19\n            }, this) : /*#__PURE__*/_jsxDEV(\"button\", {\n              onClick: stopVoiceRecognition,\n              className: \"flex items-center px-3 py-1 bg-red-500 text-white rounded hover:bg-red-600 animate-pulse\",\n              children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                className: \"mr-1\",\n                children: \"\\u23F9\\uFE0F\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 311,\n                columnNumber: 21\n              }, this), \" Detener grabaci\\xF3n\"]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 307,\n              columnNumber: 19\n            }, this), isListening && /*#__PURE__*/_jsxDEV(\"span\", {\n              className: \"ml-2 text-red-500 animate-pulse\",\n              children: \"Escuchando...\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 315,\n              columnNumber: 19\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 298,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 285,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 269,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"flex justify-between\",\n        children: [/*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: handlePreviousQuestion,\n          disabled: currentQuestionIndex === 0,\n          className: `px-4 py-2 rounded ${currentQuestionIndex === 0 ? 'bg-gray-200 text-gray-400 cursor-not-allowed' : 'bg-gray-200 text-gray-800 hover:bg-gray-300'}`,\n          children: \"Anterior\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 323,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: handleNextQuestion,\n          className: \"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700\",\n          children: currentQuestionIndex < survey.questions.length - 1 ? 'Siguiente' : 'Finalizar'\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 335,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 322,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 193,\n    columnNumber: 5\n  }, this);\n};\n_s(TakeSurvey, \"HXsG5mMR40gvPVSQKLDD3QJl5xo=\", false, function () {\n  return [useParams, useNavigate];\n});\n_c = TakeSurvey;\nexport default TakeSurvey;\nvar _c;\n$RefreshReg$(_c, \"TakeSurvey\");","map":{"version":3,"names":["React","useState","useEffect","useParams","useNavigate","SurveyService","ResponseService","LoadingSpinner","ErrorMessage","SimpleVoice","audioService","jsxDEV","_jsxDEV","Fragment","_Fragment","TakeSurvey","_s","surveyId","navigate","survey","setSurvey","loading","setLoading","error","setError","currentQuestionIndex","setCurrentQuestionIndex","responses","setResponses","isSubmitting","setIsSubmitting","showConfirmation","setShowConfirmation","currentResponse","setCurrentResponse","isListening","setIsListening","voiceEnabled","setVoiceEnabled","speechText","setSpeechText","fetchSurvey","data","getPublicSurvey","console","log","Array","questions","length","fill","initSpeechSystem","stop","currentQuestion","welcomeMessage","text","handleResponseChange","e","target","value","handleNextQuestion","updatedResponses","handlePreviousQuestion","handleSubmit","responseData","_id","map","question","index","questionId","questionText","responseText","questionType","type","submitResponse","state","message","farewell","startVoiceRecognition","isSupportedByBrowser","init","onResult","transcript","isFinal","onEnd","finalTranscript","onError","errorMessage","started","start","stopVoiceRecognition","toggleVoice","fileName","_jsxFileName","lineNumber","columnNumber","className","children","onClick","title","description","style","width","disabled","options","option","idx","onChange","rows","placeholder","_c","$RefreshReg$"],"sources":["C:/Users/josep/Documents/Sistema de Encuestas por Voz/client/src/pages/TakeSurvey.jsx"],"sourcesContent":["import React, { useState, useEffect } from 'react';\r\nimport { useParams, useNavigate } from 'react-router-dom';\r\nimport { SurveyService, ResponseService } from '../services/apiService';\r\n\r\n// Componentes\r\nimport LoadingSpinner from '../components/LoadingSpinner';\r\nimport ErrorMessage from '../components/ErrorMessage';\r\nimport SimpleVoice from '../components/SimpleVoice';\r\nimport audioService from '../services/audioService';\r\n\r\nconst TakeSurvey = () => {\r\n  const { surveyId } = useParams();\r\n  const navigate = useNavigate();\r\n  \r\n  // Estados\r\n  const [survey, setSurvey] = useState(null);\r\n  const [loading, setLoading] = useState(true);\r\n  const [error, setError] = useState(null);\r\n  const [currentQuestionIndex, setCurrentQuestionIndex] = useState(0);\r\n  const [responses, setResponses] = useState([]);\r\n  const [isSubmitting, setIsSubmitting] = useState(false);\r\n  const [showConfirmation, setShowConfirmation] = useState(false);\r\n  const [currentResponse, setCurrentResponse] = useState('');\r\n  const [isListening, setIsListening] = useState(false);\r\n  const [voiceEnabled, setVoiceEnabled] = useState(true);\r\n  const [speechText, setSpeechText] = useState('');\r\n  \r\n  // Cargar la encuesta\r\n  useEffect(() => {\r\n    const fetchSurvey = async () => {\r\n      try {\r\n        const data = await SurveyService.getPublicSurvey(surveyId);\r\n        console.log('Encuesta cargada:', data);\r\n        setSurvey(data);\r\n        // Inicializar respuestas vacías\r\n        setResponses(new Array(data.questions.length).fill(''));\r\n      } catch (error) {\r\n        console.error('Error al cargar la encuesta:', error);\r\n        setError('No se pudo cargar la encuesta. Verifique que el ID sea correcto y que la encuesta esté activa.');\r\n      } finally {\r\n        setLoading(false);\r\n      }\r\n    };\r\n    \r\n    fetchSurvey();\r\n    \r\n    // Inicializar sistema de voz\r\n    audioService.initSpeechSystem();\r\n    \r\n    return () => {\r\n      // Detener cualquier síntesis al desmontar\r\n      audioService.stop();\r\n    };\r\n  }, [surveyId]);\r\n  \r\n  // Efecto para leer la pregunta actual\r\n  useEffect(() => {\r\n    if (survey && voiceEnabled) {\r\n      const currentQuestion = survey.questions[currentQuestionIndex];\r\n      if (currentQuestion) {\r\n        // Si es la primera pregunta y hay mensaje de bienvenida, léelo primero\r\n        if (currentQuestionIndex === 0 && survey.welcomeMessage) {\r\n          setSpeechText(`${survey.welcomeMessage}. Pregunta ${currentQuestionIndex + 1}: ${currentQuestion.text}`);\r\n        } else {\r\n          setSpeechText(`Pregunta ${currentQuestionIndex + 1}: ${currentQuestion.text}`);\r\n        }\r\n      }\r\n    }\r\n  }, [currentQuestionIndex, survey, voiceEnabled]);\r\n  \r\n  // Manejar el cambio de respuesta manual\r\n  const handleResponseChange = (e) => {\r\n    setCurrentResponse(e.target.value);\r\n  };\r\n  \r\n  // Guardar la respuesta actual y avanzar a la siguiente pregunta\r\n  const handleNextQuestion = () => {\r\n    const updatedResponses = [...responses];\r\n    updatedResponses[currentQuestionIndex] = currentResponse;\r\n    setResponses(updatedResponses);\r\n    \r\n    if (currentQuestionIndex < survey.questions.length - 1) {\r\n      setCurrentQuestionIndex(currentQuestionIndex + 1);\r\n      setCurrentResponse('');\r\n    } else {\r\n      setShowConfirmation(true);\r\n      if (voiceEnabled) {\r\n        setSpeechText('Por favor, confirma tus respuestas antes de enviar la encuesta.');\r\n      }\r\n    }\r\n  };\r\n  \r\n  // Volver a la pregunta anterior\r\n  const handlePreviousQuestion = () => {\r\n    if (currentQuestionIndex > 0) {\r\n      setCurrentQuestionIndex(currentQuestionIndex - 1);\r\n      setCurrentResponse(responses[currentQuestionIndex - 1]);\r\n    }\r\n  };\r\n  \r\n  // Enviar todas las respuestas\r\n  const handleSubmit = async () => {\r\n    setIsSubmitting(true);\r\n    \r\n    try {\r\n      // Preparar objeto de respuesta\r\n      const responseData = {\r\n        surveyId: survey._id,\r\n        responses: survey.questions.map((question, index) => ({\r\n          questionId: question._id,\r\n          questionText: question.text,\r\n          responseText: responses[index] || '',\r\n          questionType: question.type\r\n        }))\r\n      };\r\n      \r\n      // Enviar respuesta a la API\r\n      await ResponseService.submitResponse(responseData);\r\n      \r\n      // Redirigir a página de agradecimiento\r\n      navigate(`/thank-you`, { \r\n        state: { \r\n          message: survey.farewell || '¡Gracias por completar la encuesta!' \r\n        } \r\n      });\r\n    } catch (error) {\r\n      console.error('Error al enviar respuestas:', error);\r\n      setError('Ocurrió un error al enviar tus respuestas. Por favor, intenta nuevamente.');\r\n      setIsSubmitting(false);\r\n    }\r\n  };\r\n  \r\n  // Iniciar reconocimiento de voz\r\n  const startVoiceRecognition = () => {\r\n    if (!audioService.isSupportedByBrowser()) {\r\n      setError('Tu navegador no soporta reconocimiento de voz');\r\n      return;\r\n    }\r\n    \r\n    audioService.init('es-ES');\r\n    \r\n    audioService.onResult((transcript, isFinal) => {\r\n      setCurrentResponse(transcript);\r\n    });\r\n    \r\n    audioService.onEnd((finalTranscript) => {\r\n      setIsListening(false);\r\n    });\r\n    \r\n    audioService.onError((errorMessage) => {\r\n      setError(`Error de reconocimiento: ${errorMessage}`);\r\n      setIsListening(false);\r\n    });\r\n    \r\n    const started = audioService.start();\r\n    if (started) {\r\n      setIsListening(true);\r\n    } else {\r\n      setError('No se pudo iniciar el reconocimiento de voz');\r\n    }\r\n  };\r\n  \r\n  // Detener reconocimiento de voz\r\n  const stopVoiceRecognition = () => {\r\n    audioService.stop();\r\n    setIsListening(false);\r\n  };\r\n  \r\n  // Alternar el uso de voz\r\n  const toggleVoice = () => {\r\n    setVoiceEnabled(!voiceEnabled);\r\n  };\r\n  \r\n  // Renderizar pantalla de carga\r\n  if (loading) {\r\n    return <LoadingSpinner />;\r\n  }\r\n  \r\n  // Renderizar mensaje de error\r\n  if (error) {\r\n    return <ErrorMessage message={error} />;\r\n  }\r\n  \r\n  // Si no hay encuesta\r\n  if (!survey) {\r\n    return <ErrorMessage message=\"No se encontró la encuesta solicitada.\" />;\r\n  }\r\n  \r\n  // Obtener la pregunta actual\r\n  const currentQuestion = survey.questions[currentQuestionIndex];\r\n  \r\n  return (\r\n    <div className=\"max-w-3xl mx-auto p-4\">\r\n      {/* Control de voz */}\r\n      <div className=\"flex justify-end mb-2\">\r\n        <button \r\n          onClick={toggleVoice} \r\n          className={`px-3 py-1 rounded text-sm ${voiceEnabled ? 'bg-blue-500 text-white' : 'bg-gray-300 text-gray-700'}`}\r\n        >\r\n          {voiceEnabled ? '🔊 Voz Activada' : '🔇 Voz Desactivada'}\r\n        </button>\r\n      </div>\r\n      \r\n      {/* Componente de síntesis de voz */}\r\n      {voiceEnabled && speechText && (\r\n        <SimpleVoice text={speechText} onEnd={() => setSpeechText('')} />\r\n      )}\r\n      \r\n      {/* Encabezado de la encuesta */}\r\n      <div className=\"mb-8 text-center\">\r\n        <h1 className=\"text-3xl font-bold mb-2\">{survey.title}</h1>\r\n        <p className=\"text-gray-600\">{survey.description}</p>\r\n        {currentQuestionIndex === 0 && survey.welcomeMessage && (\r\n          <div className=\"mt-4 p-4 bg-blue-50 rounded-lg\">\r\n            <p>{survey.welcomeMessage}</p>\r\n          </div>\r\n        )}\r\n      </div>\r\n      \r\n      {/* Progreso */}\r\n      <div className=\"mb-6\">\r\n        <div className=\"w-full bg-gray-200 rounded-full h-2.5\">\r\n          <div \r\n            className=\"bg-blue-600 h-2.5 rounded-full\" \r\n            style={{ width: `${((currentQuestionIndex + 1) / survey.questions.length) * 100}%` }}\r\n          ></div>\r\n        </div>\r\n        <p className=\"text-right text-sm mt-1\">\r\n          Pregunta {currentQuestionIndex + 1} de {survey.questions.length}\r\n        </p>\r\n      </div>\r\n      \r\n      {/* Pantalla de confirmación */}\r\n      {showConfirmation ? (\r\n        <div className=\"bg-white rounded-lg shadow-lg p-6\">\r\n          <h2 className=\"text-2xl font-bold mb-4\">Confirmar envío</h2>\r\n          <p className=\"mb-4\">¿Estás seguro de que deseas enviar tus respuestas?</p>\r\n          \r\n          <div className=\"mb-6\">\r\n            <h3 className=\"font-bold mb-2\">Resumen de respuestas:</h3>\r\n            {survey.questions.map((question, index) => (\r\n              <div key={question._id} className=\"mb-3\">\r\n                <p className=\"font-medium\">{index + 1}. {question.text}</p>\r\n                <p className=\"text-gray-700 pl-4\">{responses[index] || \"(Sin respuesta)\"}</p>\r\n              </div>\r\n            ))}\r\n          </div>\r\n          \r\n          <div className=\"flex justify-between\">\r\n            <button\r\n              onClick={() => setShowConfirmation(false)}\r\n              className=\"px-4 py-2 bg-gray-200 text-gray-800 rounded hover:bg-gray-300\"\r\n              disabled={isSubmitting}\r\n            >\r\n              Volver\r\n            </button>\r\n            <button\r\n              onClick={handleSubmit}\r\n              className=\"px-4 py-2 bg-green-600 text-white rounded hover:bg-green-700\"\r\n              disabled={isSubmitting}\r\n            >\r\n              {isSubmitting ? 'Enviando...' : 'Confirmar envío'}\r\n            </button>\r\n          </div>\r\n        </div>\r\n      ) : (\r\n        <>\r\n          {/* Pregunta actual */}\r\n          <div className=\"bg-white rounded-lg shadow-lg p-6 mb-6\">\r\n            <h2 className=\"text-xl font-bold mb-4\">{currentQuestion.text}</h2>\r\n            \r\n            {/* Opciones para preguntas de tipo opción */}\r\n            {currentQuestion.type === 'multiple_choice' && currentQuestion.options && (\r\n              <div className=\"mb-4\">\r\n                <p className=\"text-sm text-gray-600 mb-2\">Opciones:</p>\r\n                <ul className=\"list-disc pl-5\">\r\n                  {currentQuestion.options.map((option, idx) => (\r\n                    <li key={idx} className=\"mb-1\">{option}</li>\r\n                  ))}\r\n                </ul>\r\n              </div>\r\n            )}\r\n            \r\n            {/* Área de respuesta */}\r\n            <div className=\"mt-4\">\r\n              <label className=\"block text-sm font-medium text-gray-700 mb-1\">\r\n                Tu respuesta:\r\n              </label>\r\n              <textarea\r\n                value={currentResponse}\r\n                onChange={handleResponseChange}\r\n                className=\"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500\"\r\n                rows=\"3\"\r\n                placeholder=\"Escribe tu respuesta...\"\r\n              ></textarea>\r\n              \r\n              {/* Controles de reconocimiento de voz */}\r\n              <div className=\"flex items-center mt-2\">\r\n                {!isListening ? (\r\n                  <button\r\n                    onClick={startVoiceRecognition}\r\n                    className=\"flex items-center px-3 py-1 bg-blue-500 text-white rounded hover:bg-blue-600\"\r\n                  >\r\n                    <span className=\"mr-1\">🎤</span> Responder por voz\r\n                  </button>\r\n                ) : (\r\n                  <button\r\n                    onClick={stopVoiceRecognition}\r\n                    className=\"flex items-center px-3 py-1 bg-red-500 text-white rounded hover:bg-red-600 animate-pulse\"\r\n                  >\r\n                    <span className=\"mr-1\">⏹️</span> Detener grabación\r\n                  </button>\r\n                )}\r\n                {isListening && (\r\n                  <span className=\"ml-2 text-red-500 animate-pulse\">Escuchando...</span>\r\n                )}\r\n              </div>\r\n            </div>\r\n          </div>\r\n          \r\n          {/* Botones de navegación */}\r\n          <div className=\"flex justify-between\">\r\n            <button\r\n              onClick={handlePreviousQuestion}\r\n              disabled={currentQuestionIndex === 0}\r\n              className={`px-4 py-2 rounded ${\r\n                currentQuestionIndex === 0\r\n                  ? 'bg-gray-200 text-gray-400 cursor-not-allowed'\r\n                  : 'bg-gray-200 text-gray-800 hover:bg-gray-300'\r\n              }`}\r\n            >\r\n              Anterior\r\n            </button>\r\n            \r\n            <button\r\n              onClick={handleNextQuestion}\r\n              className=\"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700\"\r\n            >\r\n              {currentQuestionIndex < survey.questions.length - 1 ? 'Siguiente' : 'Finalizar'}\r\n            </button>\r\n          </div>\r\n        </>\r\n      )}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default TakeSurvey; "],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}