{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\josep\\\\Documents\\\\Sistema de Encuestas por Voz\\\\client\\\\src\\\\pages\\\\TakeSurvey.jsx\",\n  _s = $RefreshSig$();\nimport React, { useState, useEffect, useRef } from 'react';\nimport { useParams, useNavigate } from 'react-router-dom';\nimport axios from 'axios';\nimport { isSpeechRecognitionSupported, isSpeechSynthesisSupported, listenForSpeech, processVoiceResponse, checkMicrophonePermission } from '../utils/voiceSurveyAPI';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst TakeSurvey = () => {\n  _s();\n  const {\n    surveyId\n  } = useParams();\n  const navigate = useNavigate();\n  const [survey, setSurvey] = useState(null);\n  const [loading, setLoading] = useState(true);\n  const [currentStep, setCurrentStep] = useState('welcome'); // welcome, name, questions, thanks\n  const [currentQuestionIndex, setCurrentQuestionIndex] = useState(0);\n  const [userName, setUserName] = useState('');\n  const [responses, setResponses] = useState([]);\n  const [isSpeaking, setIsSpeaking] = useState(false);\n  const [isListening, setIsListening] = useState(false);\n  const [transcript, setTranscript] = useState('');\n  const [errorMessage, setErrorMessage] = useState('');\n  const [browserSupported, setBrowserSupported] = useState(true);\n  const [microphonePermission, setMicrophonePermission] = useState(null);\n\n  // Referencias\n  const recognitionRef = useRef(null);\n  const speechSynthesisRef = useRef(window.speechSynthesis);\n\n  // Comprobar compatibilidad del navegador y permisos\n  useEffect(() => {\n    const checkCompatibility = async () => {\n      // Verificar si el navegador soporta reconocimiento de voz\n      const speechRecognitionSupported = isSpeechRecognitionSupported();\n      const speechSynthesisSupported = isSpeechSynthesisSupported();\n      if (!speechRecognitionSupported || !speechSynthesisSupported) {\n        setBrowserSupported(false);\n        setErrorMessage('Su navegador no soporta las tecnologías de voz necesarias para esta encuesta. Por favor, use Chrome, Edge o Safari.');\n        return;\n      }\n\n      // Verificar permisos de micrófono\n      const hasMicrophonePermission = await checkMicrophonePermission();\n      setMicrophonePermission(hasMicrophonePermission);\n      if (!hasMicrophonePermission) {\n        setErrorMessage('Necesitamos permiso para usar su micrófono. Por favor, permita el acceso cuando se le solicite.');\n      }\n    };\n    checkCompatibility();\n  }, []);\n\n  // Obtener datos de la encuesta\n  useEffect(() => {\n    const fetchSurvey = async () => {\n      try {\n        setLoading(true);\n        // Usar el endpoint público para la encuesta\n        const response = await axios.get(`${process.env.REACT_APP_API_URL || 'http://localhost:5000'}/api/surveys/public/${surveyId}`);\n        if (response.data) {\n          setSurvey(response.data);\n          // Inicializar array de respuestas\n          setResponses(response.data.questions.map(() => ({\n            value: '',\n            timestamp: null\n          })));\n        }\n        setLoading(false);\n      } catch (error) {\n        console.error('Error fetching survey:', error);\n        setErrorMessage('Error al cargar la encuesta. Por favor, intente nuevamente.');\n        setLoading(false);\n      }\n    };\n    if (surveyId) {\n      fetchSurvey();\n    }\n  }, [surveyId]);\n\n  // Función directa y simplificada para síntesis de voz\n  const speakText = (text, onEndCallback = null) => {\n    if (!window.speechSynthesis) {\n      console.error('SpeechSynthesis no soportado');\n      return;\n    }\n\n    // Cancelar cualquier síntesis previa\n    window.speechSynthesis.cancel();\n    setIsSpeaking(true);\n    console.log('Hablando:', text);\n    const utterance = new SpeechSynthesisUtterance(text);\n    utterance.lang = 'es-ES';\n    utterance.rate = 1;\n    utterance.pitch = 1;\n    utterance.volume = 1;\n    utterance.onend = () => {\n      console.log('Síntesis de voz terminada');\n      setIsSpeaking(false);\n      if (onEndCallback) onEndCallback();\n    };\n    utterance.onerror = error => {\n      console.error('Error en síntesis de voz:', error);\n      setIsSpeaking(false);\n      setErrorMessage('Error al sintetizar voz. Por favor, intente nuevamente.');\n    };\n\n    // Reproducir\n    window.speechSynthesis.speak(utterance);\n  };\n\n  // Iniciar la encuesta cuando se carga\n  useEffect(() => {\n    if (survey && currentStep === 'welcome' && browserSupported && microphonePermission) {\n      // Uso directo de speakText sin usar la API externa\n      setTimeout(() => {\n        speakText(survey.welcomeMessage, () => {\n          setTimeout(() => {\n            setCurrentStep('name');\n            speakText('¿Podría decirme su nombre, por favor?');\n          }, 1000);\n        });\n      }, 500);\n    }\n  }, [survey, currentStep, browserSupported, microphonePermission]);\n\n  // Manejar cambios en el paso actual\n  useEffect(() => {\n    if (!survey || !browserSupported || microphonePermission === false) return;\n    if (currentStep === 'questions') {\n      askCurrentQuestion();\n    } else if (currentStep === 'thanks') {\n      speakText(survey.farewell, async () => {\n        try {\n          // Enviar respuestas al servidor\n          await submitResponses();\n        } catch (error) {\n          console.error('Error submitting responses:', error);\n        }\n      });\n    }\n  }, [currentStep, currentQuestionIndex, survey, browserSupported, microphonePermission]);\n\n  // Función para enviar respuestas al servidor\n  const submitResponses = async () => {\n    try {\n      // Transformar respuestas al formato del servidor\n      const formattedResponses = responses.map((response, index) => ({\n        questionId: survey.questions[index]._id,\n        value: response.value,\n        timestamp: response.timestamp\n      }));\n\n      // Enviar a la API\n      await axios.post(`${process.env.REACT_APP_API_URL || 'http://localhost:5000'}/api/responses`, {\n        surveyId: survey._id,\n        respondentName: userName,\n        answers: formattedResponses,\n        userAgent: navigator.userAgent,\n        completed: true\n      });\n      console.log('Respuestas enviadas correctamente');\n    } catch (error) {\n      console.error('Error enviando respuestas:', error);\n    }\n  };\n\n  // Función para iniciar escucha\n  const startListening = async () => {\n    if (isListening || isSpeaking) return;\n    setErrorMessage('');\n    setTranscript('');\n    setIsListening(true);\n    try {\n      const speechResult = await listenForSpeech();\n      setTranscript(speechResult);\n      processResponse(speechResult);\n    } catch (error) {\n      console.error('Error en reconocimiento de voz:', error);\n      setIsListening(false);\n      setErrorMessage('Error en el reconocimiento de voz. Por favor, intente nuevamente.');\n    }\n  };\n\n  // Función para procesar la respuesta del usuario\n  const processResponse = text => {\n    if (!text) return;\n    setIsListening(false);\n    if (currentStep === 'name') {\n      setUserName(text);\n      speakText(`Gracias, ${text}. Vamos a empezar con la encuesta \"${survey.title}\".`, () => {\n        setTimeout(() => {\n          setCurrentStep('questions');\n        }, 500);\n      });\n    } else if (currentStep === 'questions') {\n      const currentQuestion = survey.questions[currentQuestionIndex];\n\n      // Procesar respuesta según el tipo de pregunta\n      if (currentQuestion.type === 'rating') {\n        // Extraer número de la respuesta\n        const processedResponse = processVoiceResponse(text, 'rating');\n        if (processedResponse) {\n          saveResponse(processedResponse);\n        } else {\n          speakText('Por favor, responda con un número del 1 al 5.', startListening);\n        }\n      } else if (currentQuestion.type === 'yesno') {\n        // Verificar si la respuesta es sí o no\n        const processedResponse = processVoiceResponse(text, 'yesno');\n        if (processedResponse) {\n          saveResponse(processedResponse);\n        } else {\n          speakText('Por favor, responda con sí o no.', startListening);\n        }\n      } else {\n        // Pregunta abierta\n        saveResponse(text);\n      }\n    }\n  };\n\n  // Función para guardar respuesta y pasar a la siguiente pregunta\n  const saveResponse = value => {\n    const updatedResponses = [...responses];\n    updatedResponses[currentQuestionIndex] = {\n      value,\n      timestamp: new Date().toISOString()\n    };\n    setResponses(updatedResponses);\n\n    // Verificar si hay más preguntas\n    if (currentQuestionIndex < survey.questions.length - 1) {\n      setCurrentQuestionIndex(currentQuestionIndex + 1);\n    } else {\n      // Fin de la encuesta\n      setCurrentStep('thanks');\n    }\n  };\n\n  // Función para preguntar la pregunta actual\n  const askCurrentQuestion = () => {\n    if (!survey || currentQuestionIndex >= survey.questions.length) return;\n    const question = survey.questions[currentQuestionIndex];\n    console.log('Preguntando:', question.text);\n\n    // Agregar una pequeña pausa antes de hablar y escuchar\n    setTimeout(() => {\n      speakText(question.text, () => {\n        setTimeout(startListening, 500);\n      });\n    }, 300);\n  };\n\n  // Manejar clic en botón de micrófono\n  const handleMicrophoneClick = () => {\n    if (isListening) {\n      setIsListening(false);\n    } else {\n      startListening();\n    }\n  };\n\n  // Manejar clic en botones de opciones \n  const handleOptionClick = value => {\n    if (isSpeaking || isListening) return;\n    processResponse(value);\n  };\n\n  // Solicitar permisos de micrófono\n  const requestMicrophonePermission = async () => {\n    try {\n      const permission = await checkMicrophonePermission();\n      setMicrophonePermission(permission);\n      if (permission) {\n        // Iniciar la encuesta si se conceden los permisos\n        setCurrentStep('welcome');\n      } else {\n        setErrorMessage('No se pudo obtener permiso para el micrófono. Por favor, permita el acceso en la configuración de su navegador.');\n      }\n    } catch (error) {\n      console.error('Error al solicitar permisos de micrófono:', error);\n      setErrorMessage('Error al solicitar permisos de micrófono.');\n    }\n  };\n\n  // Mostrar botón para activar speech synthesis (requrido por Chrome)\n  const activateSpeechSynthesis = () => {\n    speakText(\"Síntesis de voz activada. Ahora puedes continuar con la encuesta.\");\n    // Reiniciar la encuesta\n    setCurrentStep('welcome');\n  };\n  if (loading) {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"flex justify-center my-12\",\n      children: /*#__PURE__*/_jsxDEV(\"svg\", {\n        className: \"animate-spin h-8 w-8 text-primary-500\",\n        xmlns: \"http://www.w3.org/2000/svg\",\n        fill: \"none\",\n        viewBox: \"0 0 24 24\",\n        children: [/*#__PURE__*/_jsxDEV(\"circle\", {\n          className: \"opacity-25\",\n          cx: \"12\",\n          cy: \"12\",\n          r: \"10\",\n          stroke: \"currentColor\",\n          strokeWidth: \"4\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 314,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"path\", {\n          className: \"opacity-75\",\n          fill: \"currentColor\",\n          d: \"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 315,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 313,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 312,\n      columnNumber: 7\n    }, this);\n  }\n  if (!survey) {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"card text-center py-12\",\n      children: [/*#__PURE__*/_jsxDEV(\"svg\", {\n        xmlns: \"http://www.w3.org/2000/svg\",\n        className: \"h-16 w-16 mx-auto text-gray-400 mb-4\",\n        fill: \"none\",\n        viewBox: \"0 0 24 24\",\n        stroke: \"currentColor\",\n        children: /*#__PURE__*/_jsxDEV(\"path\", {\n          strokeLinecap: \"round\",\n          strokeLinejoin: \"round\",\n          strokeWidth: 2,\n          d: \"M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 325,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 324,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"h3\", {\n        className: \"text-lg font-medium text-gray-800 mb-2\",\n        children: \"Encuesta no encontrada\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 327,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n        className: \"text-gray-600 mb-6\",\n        children: \"La encuesta que est\\xE1s buscando no existe o ha sido eliminada.\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 328,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: () => navigate('/'),\n        className: \"btn btn-primary\",\n        children: \"Volver al Inicio\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 329,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 323,\n      columnNumber: 7\n    }, this);\n  }\n  if (!browserSupported) {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"card text-center py-12\",\n      children: [/*#__PURE__*/_jsxDEV(\"svg\", {\n        xmlns: \"http://www.w3.org/2000/svg\",\n        className: \"h-16 w-16 mx-auto text-orange-400 mb-4\",\n        fill: \"none\",\n        viewBox: \"0 0 24 24\",\n        stroke: \"currentColor\",\n        children: /*#__PURE__*/_jsxDEV(\"path\", {\n          strokeLinecap: \"round\",\n          strokeLinejoin: \"round\",\n          strokeWidth: 2,\n          d: \"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 340,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 339,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"h3\", {\n        className: \"text-lg font-medium text-gray-800 mb-2\",\n        children: \"Navegador no compatible\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 342,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n        className: \"text-gray-600 mb-6\",\n        children: \"Esta aplicaci\\xF3n requiere un navegador compatible con la API de Reconocimiento de Voz. Por favor, utilice Chrome, Edge o Safari para continuar.\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 343,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: () => window.location.reload(),\n        className: \"btn btn-primary\",\n        children: \"Intentar Nuevamente\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 347,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 338,\n      columnNumber: 7\n    }, this);\n  }\n  if (microphonePermission === false) {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"card text-center py-12\",\n      children: [/*#__PURE__*/_jsxDEV(\"svg\", {\n        xmlns: \"http://www.w3.org/2000/svg\",\n        className: \"h-16 w-16 mx-auto text-orange-400 mb-4\",\n        fill: \"none\",\n        viewBox: \"0 0 24 24\",\n        stroke: \"currentColor\",\n        children: /*#__PURE__*/_jsxDEV(\"path\", {\n          strokeLinecap: \"round\",\n          strokeLinejoin: \"round\",\n          strokeWidth: 2,\n          d: \"M12 11c0 3.517-1.009 6.799-2.753 9.571m-3.44-2.04l.054-.09A13.916 13.916 0 008 11a4 4 0 118 0c0 1.017-.07 2.019-.203 3m-2.118 6.844A21.88 21.88 0 0015.171 17m3.839 1.132c.645-2.266.99-4.659.99-7.132A8 8 0 008 4.07M3 15.364c.64-1.319 1-2.8 1-4.364 0-1.457.39-2.823 1.07-4\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 358,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 357,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"h3\", {\n        className: \"text-lg font-medium text-gray-800 mb-2\",\n        children: \"Permiso de Micr\\xF3fono Requerido\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 360,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n        className: \"text-gray-600 mb-6\",\n        children: \"Para participar en esta encuesta por voz, necesitamos permiso para usar su micr\\xF3fono. Por favor, haga clic en el bot\\xF3n debajo para conceder acceso.\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 361,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: requestMicrophonePermission,\n        className: \"btn btn-primary\",\n        children: \"Permitir Micr\\xF3fono\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 365,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 356,\n      columnNumber: 7\n    }, this);\n  }\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"max-w-2xl mx-auto text-center\",\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"card mb-6\",\n      children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n        className: \"text-2xl font-bold mb-2\",\n        children: survey.title\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 375,\n        columnNumber: 9\n      }, this), survey.description && /*#__PURE__*/_jsxDEV(\"p\", {\n        className: \"text-gray-600 mb-6\",\n        children: survey.description\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 376,\n        columnNumber: 32\n      }, this), !isSpeaking && currentStep === 'welcome' && /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"bg-blue-100 border border-blue-400 text-blue-700 px-4 py-3 rounded mb-4\",\n        children: [/*#__PURE__*/_jsxDEV(\"p\", {\n          className: \"font-medium\",\n          children: \"Activar S\\xEDntesis de Voz\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 381,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          className: \"mb-2\",\n          children: \"Para comenzar la encuesta, primero debemos activar la s\\xEDntesis de voz.\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 382,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: activateSpeechSynthesis,\n          className: \"btn bg-blue-500 hover:bg-blue-600 text-white\",\n          children: \"Activar S\\xEDntesis de Voz\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 383,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 380,\n        columnNumber: 11\n      }, this), errorMessage && /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded mb-4\",\n        children: [errorMessage, /*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: () => setErrorMessage(''),\n          className: \"float-right font-bold\",\n          children: \"\\xD7\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 396,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 394,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"mb-8\",\n        children: [currentStep === 'welcome' && /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"text-lg\",\n          children: \"Iniciando encuesta...\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 408,\n          columnNumber: 13\n        }, this), currentStep === 'name' && /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"text-lg\",\n          children: \"\\xBFPodr\\xEDa decirme su nombre, por favor?\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 412,\n          columnNumber: 13\n        }, this), currentStep === 'questions' && survey.questions[currentQuestionIndex] && /*#__PURE__*/_jsxDEV(\"div\", {\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"text-sm text-gray-500 mb-2\",\n            children: [\"Pregunta \", currentQuestionIndex + 1, \" de \", survey.questions.length]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 417,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"text-lg font-medium mb-4\",\n            children: survey.questions[currentQuestionIndex].text\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 420,\n            columnNumber: 15\n          }, this), survey.questions[currentQuestionIndex].type === 'rating' && /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"flex justify-center space-x-2 mb-4\",\n            children: [1, 2, 3, 4, 5].map(num => /*#__PURE__*/_jsxDEV(\"button\", {\n              className: \"w-12 h-12 rounded-full bg-gray-200 hover:bg-primary-100 flex items-center justify-center font-medium text-gray-800\",\n              onClick: () => handleOptionClick(num.toString()),\n              disabled: isSpeaking || isListening,\n              children: num\n            }, num, false, {\n              fileName: _jsxFileName,\n              lineNumber: 427,\n              columnNumber: 21\n            }, this))\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 425,\n            columnNumber: 17\n          }, this), survey.questions[currentQuestionIndex].type === 'yesno' && /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"flex justify-center space-x-4 mb-4\",\n            children: [/*#__PURE__*/_jsxDEV(\"button\", {\n              className: \"btn btn-outline px-8\",\n              onClick: () => handleOptionClick('No'),\n              disabled: isSpeaking || isListening,\n              children: \"No\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 441,\n              columnNumber: 19\n            }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n              className: \"btn btn-primary px-8\",\n              onClick: () => handleOptionClick('Sí'),\n              disabled: isSpeaking || isListening,\n              children: \"S\\xED\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 448,\n              columnNumber: 19\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 440,\n            columnNumber: 17\n          }, this), survey.questions[currentQuestionIndex].type === 'single' && survey.questions[currentQuestionIndex].options && /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"flex flex-col space-y-2 mb-4\",\n            children: survey.questions[currentQuestionIndex].options.map((option, index) => /*#__PURE__*/_jsxDEV(\"button\", {\n              className: \"btn btn-outline w-full text-left px-4 py-2\",\n              onClick: () => handleOptionClick(option),\n              disabled: isSpeaking || isListening,\n              children: option\n            }, index, false, {\n              fileName: _jsxFileName,\n              lineNumber: 462,\n              columnNumber: 21\n            }, this))\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 460,\n            columnNumber: 17\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 416,\n          columnNumber: 13\n        }, this), currentStep === 'thanks' && /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"text-lg\",\n          children: survey.farewell\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 477,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 406,\n        columnNumber: 9\n      }, this), transcript && /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"bg-gray-100 p-4 rounded-lg mb-6\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"text-sm text-gray-500 mb-1\",\n          children: \"Tu respuesta:\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 484,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"text-lg\",\n          children: transcript\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 485,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 483,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"flex justify-center\",\n        children: /*#__PURE__*/_jsxDEV(\"button\", {\n          className: `w-20 h-20 rounded-full flex items-center justify-center transition-colors ${isListening ? 'bg-red-500 text-white animate-pulse' : isSpeaking ? 'bg-gray-300 text-gray-600 cursor-not-allowed' : 'bg-primary-500 text-white hover:bg-primary-600'}`,\n          onClick: handleMicrophoneClick,\n          disabled: isSpeaking || currentStep === 'welcome' || currentStep === 'thanks',\n          title: isListening ? 'Detener grabación' : 'Iniciar grabación',\n          children: isListening ? /*#__PURE__*/_jsxDEV(\"svg\", {\n            xmlns: \"http://www.w3.org/2000/svg\",\n            className: \"h-8 w-8\",\n            fill: \"none\",\n            viewBox: \"0 0 24 24\",\n            stroke: \"currentColor\",\n            children: [/*#__PURE__*/_jsxDEV(\"path\", {\n              strokeLinecap: \"round\",\n              strokeLinejoin: \"round\",\n              strokeWidth: 2,\n              d: \"M21 12a9 9 0 11-18 0 9 9 0 0118 0z\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 505,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"path\", {\n              strokeLinecap: \"round\",\n              strokeLinejoin: \"round\",\n              strokeWidth: 2,\n              d: \"M9 10a1 1 0 011-1h4a1 1 0 011 1v4a1 1 0 01-1 1h-4a1 1 0 01-1-1v-4z\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 506,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 504,\n            columnNumber: 15\n          }, this) : /*#__PURE__*/_jsxDEV(\"svg\", {\n            xmlns: \"http://www.w3.org/2000/svg\",\n            className: \"h-8 w-8\",\n            fill: \"none\",\n            viewBox: \"0 0 24 24\",\n            stroke: \"currentColor\",\n            children: /*#__PURE__*/_jsxDEV(\"path\", {\n              strokeLinecap: \"round\",\n              strokeLinejoin: \"round\",\n              strokeWidth: 2,\n              d: \"M19 11a7 7 0 01-7 7m0 0a7 7 0 01-7-7m7 7v4m0 0H8m4 0h4m-4-8a3 3 0 01-3-3V5a3 3 0 116 0v6a3 3 0 01-3 3z\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 510,\n              columnNumber: 17\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 509,\n            columnNumber: 15\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 491,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 490,\n        columnNumber: 9\n      }, this), currentStep === 'questions' && /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"mt-8\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"w-full bg-gray-200 rounded-full h-2.5\",\n          children: /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"bg-primary-500 h-2.5 rounded-full\",\n            style: {\n              width: `${currentQuestionIndex / survey.questions.length * 100}%`\n            }\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 520,\n            columnNumber: 15\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 519,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"text-xs text-gray-500 mt-2\",\n          children: [currentQuestionIndex, \" de \", survey.questions.length, \" preguntas completadas\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 525,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 518,\n        columnNumber: 11\n      }, this), currentStep === 'thanks' && /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"mt-6 space-y-4\",\n        children: [/*#__PURE__*/_jsxDEV(\"p\", {\n          className: \"text-green-600\",\n          children: \"Sus respuestas han sido guardadas correctamente.\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 534,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: () => navigate('/surveys/public'),\n          className: \"btn btn-primary\",\n          children: \"Ver Otras Encuestas\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 535,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: () => navigate('/'),\n          className: \"btn btn-outline block mx-auto mt-2\",\n          children: \"Volver al Inicio\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 541,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 533,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 374,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"bg-gray-50 p-4 rounded-lg text-sm text-gray-600\",\n      children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n        className: \"font-medium mb-2\",\n        children: \"Instrucciones:\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 553,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"ul\", {\n        className: \"list-disc list-inside space-y-1\",\n        children: [/*#__PURE__*/_jsxDEV(\"li\", {\n          children: \"Primero active la s\\xEDntesis de voz haciendo clic en el bot\\xF3n azul\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 555,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"li\", {\n          children: \"Haga clic en el bot\\xF3n del micr\\xF3fono para comenzar a hablar\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 556,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"li\", {\n          children: \"Responda claramente a las preguntas cuando se le indique\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 557,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"li\", {\n          children: \"Para preguntas de calificaci\\xF3n, responda con un n\\xFAmero del 1 al 5\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 558,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"li\", {\n          children: \"Para preguntas de s\\xED/no, responda con \\\"s\\xED\\\" o \\\"no\\\"\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 559,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"li\", {\n          children: \"Tambi\\xE9n puede usar los botones en pantalla para responder\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 560,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 554,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 552,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 373,\n    columnNumber: 5\n  }, this);\n};\n_s(TakeSurvey, \"u3F1J05AVo3v7YaflsvJco098j8=\", false, function () {\n  return [useParams, useNavigate];\n});\n_c = TakeSurvey;\nexport default TakeSurvey;\nvar _c;\n$RefreshReg$(_c, \"TakeSurvey\");","map":{"version":3,"names":["React","useState","useEffect","useRef","useParams","useNavigate","axios","isSpeechRecognitionSupported","isSpeechSynthesisSupported","listenForSpeech","processVoiceResponse","checkMicrophonePermission","jsxDEV","_jsxDEV","TakeSurvey","_s","surveyId","navigate","survey","setSurvey","loading","setLoading","currentStep","setCurrentStep","currentQuestionIndex","setCurrentQuestionIndex","userName","setUserName","responses","setResponses","isSpeaking","setIsSpeaking","isListening","setIsListening","transcript","setTranscript","errorMessage","setErrorMessage","browserSupported","setBrowserSupported","microphonePermission","setMicrophonePermission","recognitionRef","speechSynthesisRef","window","speechSynthesis","checkCompatibility","speechRecognitionSupported","speechSynthesisSupported","hasMicrophonePermission","fetchSurvey","response","get","process","env","REACT_APP_API_URL","data","questions","map","value","timestamp","error","console","speakText","text","onEndCallback","cancel","log","utterance","SpeechSynthesisUtterance","lang","rate","pitch","volume","onend","onerror","speak","setTimeout","welcomeMessage","askCurrentQuestion","farewell","submitResponses","formattedResponses","index","questionId","_id","post","respondentName","answers","userAgent","navigator","completed","startListening","speechResult","processResponse","title","currentQuestion","type","processedResponse","saveResponse","updatedResponses","Date","toISOString","length","question","handleMicrophoneClick","handleOptionClick","requestMicrophonePermission","permission","activateSpeechSynthesis","className","children","xmlns","fill","viewBox","cx","cy","r","stroke","strokeWidth","fileName","_jsxFileName","lineNumber","columnNumber","d","strokeLinecap","strokeLinejoin","onClick","location","reload","description","num","toString","disabled","options","option","style","width","_c","$RefreshReg$"],"sources":["C:/Users/josep/Documents/Sistema de Encuestas por Voz/client/src/pages/TakeSurvey.jsx"],"sourcesContent":["import React, { useState, useEffect, useRef } from 'react';\nimport { useParams, useNavigate } from 'react-router-dom';\nimport axios from 'axios';\nimport {\n  isSpeechRecognitionSupported,\n  isSpeechSynthesisSupported,\n  listenForSpeech,\n  processVoiceResponse,\n  checkMicrophonePermission\n} from '../utils/voiceSurveyAPI';\n\nconst TakeSurvey = () => {\n  const { surveyId } = useParams();\n  const navigate = useNavigate();\n  const [survey, setSurvey] = useState(null);\n  const [loading, setLoading] = useState(true);\n  const [currentStep, setCurrentStep] = useState('welcome'); // welcome, name, questions, thanks\n  const [currentQuestionIndex, setCurrentQuestionIndex] = useState(0);\n  const [userName, setUserName] = useState('');\n  const [responses, setResponses] = useState([]);\n  const [isSpeaking, setIsSpeaking] = useState(false);\n  const [isListening, setIsListening] = useState(false);\n  const [transcript, setTranscript] = useState('');\n  const [errorMessage, setErrorMessage] = useState('');\n  const [browserSupported, setBrowserSupported] = useState(true);\n  const [microphonePermission, setMicrophonePermission] = useState(null);\n  \n  // Referencias\n  const recognitionRef = useRef(null);\n  const speechSynthesisRef = useRef(window.speechSynthesis);\n  \n  // Comprobar compatibilidad del navegador y permisos\n  useEffect(() => {\n    const checkCompatibility = async () => {\n      // Verificar si el navegador soporta reconocimiento de voz\n      const speechRecognitionSupported = isSpeechRecognitionSupported();\n      const speechSynthesisSupported = isSpeechSynthesisSupported();\n      \n      if (!speechRecognitionSupported || !speechSynthesisSupported) {\n        setBrowserSupported(false);\n        setErrorMessage('Su navegador no soporta las tecnologías de voz necesarias para esta encuesta. Por favor, use Chrome, Edge o Safari.');\n        return;\n      }\n      \n      // Verificar permisos de micrófono\n      const hasMicrophonePermission = await checkMicrophonePermission();\n      setMicrophonePermission(hasMicrophonePermission);\n      \n      if (!hasMicrophonePermission) {\n        setErrorMessage('Necesitamos permiso para usar su micrófono. Por favor, permita el acceso cuando se le solicite.');\n      }\n    };\n    \n    checkCompatibility();\n  }, []);\n  \n  // Obtener datos de la encuesta\n  useEffect(() => {\n    const fetchSurvey = async () => {\n      try {\n        setLoading(true);\n        // Usar el endpoint público para la encuesta\n        const response = await axios.get(`${process.env.REACT_APP_API_URL || 'http://localhost:5000'}/api/surveys/public/${surveyId}`);\n        \n        if (response.data) {\n          setSurvey(response.data);\n          // Inicializar array de respuestas\n          setResponses(response.data.questions.map(() => ({ value: '', timestamp: null })));\n        }\n        \n        setLoading(false);\n      } catch (error) {\n        console.error('Error fetching survey:', error);\n        setErrorMessage('Error al cargar la encuesta. Por favor, intente nuevamente.');\n        setLoading(false);\n      }\n    };\n\n    if (surveyId) {\n      fetchSurvey();\n    }\n  }, [surveyId]);\n  \n  // Función directa y simplificada para síntesis de voz\n  const speakText = (text, onEndCallback = null) => {\n    if (!window.speechSynthesis) {\n      console.error('SpeechSynthesis no soportado');\n      return;\n    }\n    \n    // Cancelar cualquier síntesis previa\n    window.speechSynthesis.cancel();\n    \n    setIsSpeaking(true);\n    console.log('Hablando:', text);\n    \n    const utterance = new SpeechSynthesisUtterance(text);\n    utterance.lang = 'es-ES';\n    utterance.rate = 1;\n    utterance.pitch = 1;\n    utterance.volume = 1;\n    \n    utterance.onend = () => {\n      console.log('Síntesis de voz terminada');\n      setIsSpeaking(false);\n      if (onEndCallback) onEndCallback();\n    };\n    \n    utterance.onerror = (error) => {\n      console.error('Error en síntesis de voz:', error);\n      setIsSpeaking(false);\n      setErrorMessage('Error al sintetizar voz. Por favor, intente nuevamente.');\n    };\n    \n    // Reproducir\n    window.speechSynthesis.speak(utterance);\n  };\n  \n  // Iniciar la encuesta cuando se carga\n  useEffect(() => {\n    if (survey && currentStep === 'welcome' && browserSupported && microphonePermission) {\n      // Uso directo de speakText sin usar la API externa\n      setTimeout(() => {\n        speakText(survey.welcomeMessage, () => {\n          setTimeout(() => {\n            setCurrentStep('name');\n            speakText('¿Podría decirme su nombre, por favor?');\n          }, 1000);\n        });\n      }, 500);\n    }\n  }, [survey, currentStep, browserSupported, microphonePermission]);\n  \n  // Manejar cambios en el paso actual\n  useEffect(() => {\n    if (!survey || !browserSupported || microphonePermission === false) return;\n    \n    if (currentStep === 'questions') {\n      askCurrentQuestion();\n    } else if (currentStep === 'thanks') {\n      speakText(survey.farewell, async () => {\n        try {\n          // Enviar respuestas al servidor\n          await submitResponses();\n        } catch (error) {\n          console.error('Error submitting responses:', error);\n        }\n      });\n    }\n  }, [currentStep, currentQuestionIndex, survey, browserSupported, microphonePermission]);\n  \n  // Función para enviar respuestas al servidor\n  const submitResponses = async () => {\n    try {\n      // Transformar respuestas al formato del servidor\n      const formattedResponses = responses.map((response, index) => ({\n        questionId: survey.questions[index]._id,\n        value: response.value,\n        timestamp: response.timestamp\n      }));\n      \n      // Enviar a la API\n      await axios.post(`${process.env.REACT_APP_API_URL || 'http://localhost:5000'}/api/responses`, {\n        surveyId: survey._id,\n        respondentName: userName,\n        answers: formattedResponses,\n        userAgent: navigator.userAgent,\n        completed: true\n      });\n      \n      console.log('Respuestas enviadas correctamente');\n    } catch (error) {\n      console.error('Error enviando respuestas:', error);\n    }\n  };\n  \n  // Función para iniciar escucha\n  const startListening = async () => {\n    if (isListening || isSpeaking) return;\n    \n    setErrorMessage('');\n    setTranscript('');\n    setIsListening(true);\n    \n    try {\n      const speechResult = await listenForSpeech();\n      setTranscript(speechResult);\n      processResponse(speechResult);\n    } catch (error) {\n      console.error('Error en reconocimiento de voz:', error);\n      setIsListening(false);\n      setErrorMessage('Error en el reconocimiento de voz. Por favor, intente nuevamente.');\n    }\n  };\n  \n  // Función para procesar la respuesta del usuario\n  const processResponse = (text) => {\n    if (!text) return;\n    \n    setIsListening(false);\n    \n    if (currentStep === 'name') {\n      setUserName(text);\n      speakText(`Gracias, ${text}. Vamos a empezar con la encuesta \"${survey.title}\".`, () => {\n        setTimeout(() => {\n          setCurrentStep('questions');\n        }, 500);\n      });\n    } else if (currentStep === 'questions') {\n      const currentQuestion = survey.questions[currentQuestionIndex];\n      \n      // Procesar respuesta según el tipo de pregunta\n      if (currentQuestion.type === 'rating') {\n        // Extraer número de la respuesta\n        const processedResponse = processVoiceResponse(text, 'rating');\n        if (processedResponse) {\n          saveResponse(processedResponse);\n        } else {\n          speakText('Por favor, responda con un número del 1 al 5.', startListening);\n        }\n      } else if (currentQuestion.type === 'yesno') {\n        // Verificar si la respuesta es sí o no\n        const processedResponse = processVoiceResponse(text, 'yesno');\n        if (processedResponse) {\n          saveResponse(processedResponse);\n        } else {\n          speakText('Por favor, responda con sí o no.', startListening);\n        }\n      } else {\n        // Pregunta abierta\n        saveResponse(text);\n      }\n    }\n  };\n  \n  // Función para guardar respuesta y pasar a la siguiente pregunta\n  const saveResponse = (value) => {\n    const updatedResponses = [...responses];\n    updatedResponses[currentQuestionIndex] = {\n      value,\n      timestamp: new Date().toISOString()\n    };\n    setResponses(updatedResponses);\n    \n    // Verificar si hay más preguntas\n    if (currentQuestionIndex < survey.questions.length - 1) {\n      setCurrentQuestionIndex(currentQuestionIndex + 1);\n    } else {\n      // Fin de la encuesta\n      setCurrentStep('thanks');\n    }\n  };\n  \n  // Función para preguntar la pregunta actual\n  const askCurrentQuestion = () => {\n    if (!survey || currentQuestionIndex >= survey.questions.length) return;\n    \n    const question = survey.questions[currentQuestionIndex];\n    console.log('Preguntando:', question.text);\n    \n    // Agregar una pequeña pausa antes de hablar y escuchar\n    setTimeout(() => {\n      speakText(question.text, () => {\n        setTimeout(startListening, 500);\n      });\n    }, 300);\n  };\n  \n  // Manejar clic en botón de micrófono\n  const handleMicrophoneClick = () => {\n    if (isListening) {\n      setIsListening(false);\n    } else {\n      startListening();\n    }\n  };\n  \n  // Manejar clic en botones de opciones \n  const handleOptionClick = (value) => {\n    if (isSpeaking || isListening) return;\n    \n    processResponse(value);\n  };\n\n  // Solicitar permisos de micrófono\n  const requestMicrophonePermission = async () => {\n    try {\n      const permission = await checkMicrophonePermission();\n      setMicrophonePermission(permission);\n      \n      if (permission) {\n        // Iniciar la encuesta si se conceden los permisos\n        setCurrentStep('welcome');\n      } else {\n        setErrorMessage('No se pudo obtener permiso para el micrófono. Por favor, permita el acceso en la configuración de su navegador.');\n      }\n    } catch (error) {\n      console.error('Error al solicitar permisos de micrófono:', error);\n      setErrorMessage('Error al solicitar permisos de micrófono.');\n    }\n  };\n  \n  // Mostrar botón para activar speech synthesis (requrido por Chrome)\n  const activateSpeechSynthesis = () => {\n    speakText(\"Síntesis de voz activada. Ahora puedes continuar con la encuesta.\");\n    // Reiniciar la encuesta\n    setCurrentStep('welcome');\n  };\n  \n  if (loading) {\n    return (\n      <div className=\"flex justify-center my-12\">\n        <svg className=\"animate-spin h-8 w-8 text-primary-500\" xmlns=\"http://www.w3.org/2000/svg\" fill=\"none\" viewBox=\"0 0 24 24\">\n          <circle className=\"opacity-25\" cx=\"12\" cy=\"12\" r=\"10\" stroke=\"currentColor\" strokeWidth=\"4\"></circle>\n          <path className=\"opacity-75\" fill=\"currentColor\" d=\"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z\"></path>\n        </svg>\n      </div>\n    );\n  }\n  \n  if (!survey) {\n    return (\n      <div className=\"card text-center py-12\">\n        <svg xmlns=\"http://www.w3.org/2000/svg\" className=\"h-16 w-16 mx-auto text-gray-400 mb-4\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\n          <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2\" />\n        </svg>\n        <h3 className=\"text-lg font-medium text-gray-800 mb-2\">Encuesta no encontrada</h3>\n        <p className=\"text-gray-600 mb-6\">La encuesta que estás buscando no existe o ha sido eliminada.</p>\n        <button onClick={() => navigate('/')} className=\"btn btn-primary\">\n          Volver al Inicio\n        </button>\n      </div>\n    );\n  }\n  \n  if (!browserSupported) {\n    return (\n      <div className=\"card text-center py-12\">\n        <svg xmlns=\"http://www.w3.org/2000/svg\" className=\"h-16 w-16 mx-auto text-orange-400 mb-4\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\n          <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z\" />\n        </svg>\n        <h3 className=\"text-lg font-medium text-gray-800 mb-2\">Navegador no compatible</h3>\n        <p className=\"text-gray-600 mb-6\">\n          Esta aplicación requiere un navegador compatible con la API de Reconocimiento de Voz.\n          Por favor, utilice Chrome, Edge o Safari para continuar.\n        </p>\n        <button onClick={() => window.location.reload()} className=\"btn btn-primary\">\n          Intentar Nuevamente\n        </button>\n      </div>\n    );\n  }\n  \n  if (microphonePermission === false) {\n    return (\n      <div className=\"card text-center py-12\">\n        <svg xmlns=\"http://www.w3.org/2000/svg\" className=\"h-16 w-16 mx-auto text-orange-400 mb-4\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\n          <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M12 11c0 3.517-1.009 6.799-2.753 9.571m-3.44-2.04l.054-.09A13.916 13.916 0 008 11a4 4 0 118 0c0 1.017-.07 2.019-.203 3m-2.118 6.844A21.88 21.88 0 0015.171 17m3.839 1.132c.645-2.266.99-4.659.99-7.132A8 8 0 008 4.07M3 15.364c.64-1.319 1-2.8 1-4.364 0-1.457.39-2.823 1.07-4\" />\n        </svg>\n        <h3 className=\"text-lg font-medium text-gray-800 mb-2\">Permiso de Micrófono Requerido</h3>\n        <p className=\"text-gray-600 mb-6\">\n          Para participar en esta encuesta por voz, necesitamos permiso para usar su micrófono.\n          Por favor, haga clic en el botón debajo para conceder acceso.\n        </p>\n        <button onClick={requestMicrophonePermission} className=\"btn btn-primary\">\n          Permitir Micrófono\n        </button>\n      </div>\n    );\n  }\n  \n  return (\n    <div className=\"max-w-2xl mx-auto text-center\">\n      <div className=\"card mb-6\">\n        <h1 className=\"text-2xl font-bold mb-2\">{survey.title}</h1>\n        {survey.description && <p className=\"text-gray-600 mb-6\">{survey.description}</p>}\n        \n        {/* Mensaje de activación para Chrome */}\n        {!isSpeaking && currentStep === 'welcome' && (\n          <div className=\"bg-blue-100 border border-blue-400 text-blue-700 px-4 py-3 rounded mb-4\">\n            <p className=\"font-medium\">Activar Síntesis de Voz</p>\n            <p className=\"mb-2\">Para comenzar la encuesta, primero debemos activar la síntesis de voz.</p>\n            <button \n              onClick={activateSpeechSynthesis}\n              className=\"btn bg-blue-500 hover:bg-blue-600 text-white\"\n            >\n              Activar Síntesis de Voz\n            </button>\n          </div>\n        )}\n        \n        {/* Mostrar mensaje de error si existe */}\n        {errorMessage && (\n          <div className=\"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded mb-4\">\n            {errorMessage}\n            <button \n              onClick={() => setErrorMessage('')}\n              className=\"float-right font-bold\"\n            >\n              &times;\n            </button>\n          </div>\n        )}\n        \n        {/* Mostrar estado actual */}\n        <div className=\"mb-8\">\n          {currentStep === 'welcome' && (\n            <div className=\"text-lg\">Iniciando encuesta...</div>\n          )}\n          \n          {currentStep === 'name' && (\n            <div className=\"text-lg\">¿Podría decirme su nombre, por favor?</div>\n          )}\n          \n          {currentStep === 'questions' && survey.questions[currentQuestionIndex] && (\n            <div>\n              <div className=\"text-sm text-gray-500 mb-2\">\n                Pregunta {currentQuestionIndex + 1} de {survey.questions.length}\n              </div>\n              <div className=\"text-lg font-medium mb-4\">\n                {survey.questions[currentQuestionIndex].text}\n              </div>\n              \n              {survey.questions[currentQuestionIndex].type === 'rating' && (\n                <div className=\"flex justify-center space-x-2 mb-4\">\n                  {[1, 2, 3, 4, 5].map((num) => (\n                    <button\n                      key={num}\n                      className=\"w-12 h-12 rounded-full bg-gray-200 hover:bg-primary-100 flex items-center justify-center font-medium text-gray-800\"\n                      onClick={() => handleOptionClick(num.toString())}\n                      disabled={isSpeaking || isListening}\n                    >\n                      {num}\n                    </button>\n                  ))}\n                </div>\n              )}\n              \n              {survey.questions[currentQuestionIndex].type === 'yesno' && (\n                <div className=\"flex justify-center space-x-4 mb-4\">\n                  <button\n                    className=\"btn btn-outline px-8\"\n                    onClick={() => handleOptionClick('No')}\n                    disabled={isSpeaking || isListening}\n                  >\n                    No\n                  </button>\n                  <button\n                    className=\"btn btn-primary px-8\"\n                    onClick={() => handleOptionClick('Sí')}\n                    disabled={isSpeaking || isListening}\n                  >\n                    Sí\n                  </button>\n                </div>\n              )}\n              \n              {/* Para preguntas de selección múltiple */}\n              {survey.questions[currentQuestionIndex].type === 'single' && survey.questions[currentQuestionIndex].options && (\n                <div className=\"flex flex-col space-y-2 mb-4\">\n                  {survey.questions[currentQuestionIndex].options.map((option, index) => (\n                    <button\n                      key={index}\n                      className=\"btn btn-outline w-full text-left px-4 py-2\"\n                      onClick={() => handleOptionClick(option)}\n                      disabled={isSpeaking || isListening}\n                    >\n                      {option}\n                    </button>\n                  ))}\n                </div>\n              )}\n            </div>\n          )}\n          \n          {currentStep === 'thanks' && (\n            <div className=\"text-lg\">{survey.farewell}</div>\n          )}\n        </div>\n        \n        {/* Mostrar transcripción */}\n        {transcript && (\n          <div className=\"bg-gray-100 p-4 rounded-lg mb-6\">\n            <div className=\"text-sm text-gray-500 mb-1\">Tu respuesta:</div>\n            <div className=\"text-lg\">{transcript}</div>\n          </div>\n        )}\n        \n        {/* Botón de micrófono */}\n        <div className=\"flex justify-center\">\n          <button\n            className={`w-20 h-20 rounded-full flex items-center justify-center transition-colors ${\n              isListening\n                ? 'bg-red-500 text-white animate-pulse'\n                : isSpeaking\n                ? 'bg-gray-300 text-gray-600 cursor-not-allowed'\n                : 'bg-primary-500 text-white hover:bg-primary-600'\n            }`}\n            onClick={handleMicrophoneClick}\n            disabled={isSpeaking || currentStep === 'welcome' || currentStep === 'thanks'}\n            title={isListening ? 'Detener grabación' : 'Iniciar grabación'}\n          >\n            {isListening ? (\n              <svg xmlns=\"http://www.w3.org/2000/svg\" className=\"h-8 w-8\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\n                <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M21 12a9 9 0 11-18 0 9 9 0 0118 0z\" />\n                <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M9 10a1 1 0 011-1h4a1 1 0 011 1v4a1 1 0 01-1 1h-4a1 1 0 01-1-1v-4z\" />\n              </svg>\n            ) : (\n              <svg xmlns=\"http://www.w3.org/2000/svg\" className=\"h-8 w-8\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\n                <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M19 11a7 7 0 01-7 7m0 0a7 7 0 01-7-7m7 7v4m0 0H8m4 0h4m-4-8a3 3 0 01-3-3V5a3 3 0 116 0v6a3 3 0 01-3 3z\" />\n              </svg>\n            )}\n          </button>\n        </div>\n        \n        {/* Indicadores de progreso */}\n        {currentStep === 'questions' && (\n          <div className=\"mt-8\">\n            <div className=\"w-full bg-gray-200 rounded-full h-2.5\">\n              <div\n                className=\"bg-primary-500 h-2.5 rounded-full\"\n                style={{ width: `${((currentQuestionIndex) / survey.questions.length) * 100}%` }}\n              ></div>\n            </div>\n            <div className=\"text-xs text-gray-500 mt-2\">\n              {currentQuestionIndex} de {survey.questions.length} preguntas completadas\n            </div>\n          </div>\n        )}\n        \n        {/* Acciones finales */}\n        {currentStep === 'thanks' && (\n          <div className=\"mt-6 space-y-4\">\n            <p className=\"text-green-600\">Sus respuestas han sido guardadas correctamente.</p>\n            <button\n              onClick={() => navigate('/surveys/public')}\n              className=\"btn btn-primary\"\n            >\n              Ver Otras Encuestas\n            </button>\n            <button\n              onClick={() => navigate('/')}\n              className=\"btn btn-outline block mx-auto mt-2\"\n            >\n              Volver al Inicio\n            </button>\n          </div>\n        )}\n      </div>\n      \n      {/* Instrucciones */}\n      <div className=\"bg-gray-50 p-4 rounded-lg text-sm text-gray-600\">\n        <h3 className=\"font-medium mb-2\">Instrucciones:</h3>\n        <ul className=\"list-disc list-inside space-y-1\">\n          <li>Primero active la síntesis de voz haciendo clic en el botón azul</li>\n          <li>Haga clic en el botón del micrófono para comenzar a hablar</li>\n          <li>Responda claramente a las preguntas cuando se le indique</li>\n          <li>Para preguntas de calificación, responda con un número del 1 al 5</li>\n          <li>Para preguntas de sí/no, responda con \"sí\" o \"no\"</li>\n          <li>También puede usar los botones en pantalla para responder</li>\n        </ul>\n      </div>\n    </div>\n  );\n};\n\nexport default TakeSurvey;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}